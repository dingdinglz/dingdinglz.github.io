<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ä»Šå¤©è¦è¯»çš„é¡¹ç›®æ˜¯ï¼šhttps://github.com/HKUDS/DeepCode"><title>dinglzå¸¦ä½ è¯»deepcode</title>
<link rel=canonical href=https://dingdinglz.github.io/p/dinglz%E5%B8%A6%E4%BD%A0%E8%AF%BBdeepcode/><link rel=stylesheet href=/scss/style.min.81579ea678e30582aa60028bfe3192821d6c0fee666ee279be318fb5b558916b.css><meta property='og:title' content="dinglzå¸¦ä½ è¯»deepcode"><meta property='og:description' content="ä»Šå¤©è¦è¯»çš„é¡¹ç›®æ˜¯ï¼šhttps://github.com/HKUDS/DeepCode"><meta property='og:url' content='https://dingdinglz.github.io/p/dinglz%E5%B8%A6%E4%BD%A0%E8%AF%BBdeepcode/'><meta property='og:site_name' content="Dinglz 's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Python'><meta property='article:tag' content='Agent'><meta property='article:published_time' content='2026-01-18T02:00:00+00:00'><meta property='article:modified_time' content='2026-01-18T02:00:00+00:00'><meta name=twitter:title content="dinglzå¸¦ä½ è¯»deepcode"><meta name=twitter:description content="ä»Šå¤©è¦è¯»çš„é¡¹ç›®æ˜¯ï¼šhttps://github.com/HKUDS/DeepCode"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu9713755695089526605.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Dinglz 's Blog</a></h1><h2 class=site-description>keep learning...</h2></div></header><ol class=menu-social><li><a href=https://github.com/dingdinglz target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>åˆ†ç±»</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#æ¦‚è¿°>æ¦‚è¿°</a></li><li><a href=#å…¥å£>å…¥å£</a></li><li><a href=#mcpéƒ¨åˆ†>mcpéƒ¨åˆ†</a></li><li><a href=#appprocess_inputinput_source-input_type>app.process_input(input_source, input_type)</a></li><li><a href=#selfexecute_full_pipeline>self.execute_full_pipeline</a></li><li><a href=#execute_multi_agent_research_pipeline>execute_multi_agent_research_pipeline</a><ol><li><a href=#phase0>phase0</a></li><li><a href=#phase1>phase1</a></li><li><a href=#phase2>phase2</a><ol><li><a href=#orchestrate_research_analysis_agent>orchestrate_research_analysis_agent</a></li></ol></li><li><a href=#phase3>phase3</a></li><li><a href=#phase35>phase3.5</a><ol><li><a href=#step1>step1</a></li><li><a href=#step2>step2</a></li><li><a href=#step3>step3</a></li></ol></li><li><a href=#phase4>phase4</a><ol><li><a href=#concept_analysis>concept_analysis</a></li><li><a href=#algorithm_analysis>algorithm_analysis</a></li><li><a href=#code_planning>code_planning</a></li></ol></li><li><a href=#phase-5>phase 5</a></li><li><a href=#phase-6>phase 6</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/coderead/ style=background-color:#6495ed;color:#fff>dinglzå¸¦ä½ è¯»github</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/dinglz%E5%B8%A6%E4%BD%A0%E8%AF%BBdeepcode/>dinglzå¸¦ä½ è¯»deepcode</a></h2><h3 class=article-subtitle>ä»Šå¤©è¦è¯»çš„é¡¹ç›®æ˜¯ï¼šhttps://github.com/HKUDS/DeepCode</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2026-01-18T02:00:00Z>Jan 18, 2026</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>29 minute read</time></div></footer></div></header><section class=article-content><p>ä»Šå¤©æˆ‘ä»¬è¦çœ‹çš„é¡¹ç›®æ˜¯ï¼šhttps://github.com/HKUDS/DeepCode ï¼Œæˆ‘è¯»çš„commitæ˜¯mainåˆ†æ”¯çš„ab730642731d9c8a400cad78e76962253ac875f2</p><p>è·Ÿç€æœ¬ç¯‡blogè¯»repoå»ºè®®æŠŠä»£ç æ‹‰ä¸‹æ¥ï¼Œåˆ‡åˆ°ç›¸åŒçš„commitï¼Œè·Ÿç€æµç¨‹ä¸€èµ·æ¥è¯»</p><h2 id=æ¦‚è¿°>æ¦‚è¿°</h2><p>DeepCode æ˜¯ä¸€ä¸ªåŸºäºå¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„å¼€æºæ¡†æ¶ï¼Œæ—¨åœ¨å°†ç ”ç©¶è®ºæ–‡ã€è‡ªç„¶è¯­è¨€æè¿°ç­‰è¾“å…¥è‡ªåŠ¨è½¬æ¢ä¸ºç”Ÿäº§çº§ä»£ç ã€‚è¯¥é¡¹ç›®é€šè¿‡è‡ªåŠ¨åŒ–ç®—æ³•å®ç°ã€å‰ç«¯å¼€å‘å’Œåç«¯æ„å»ºï¼Œæ˜¾è‘—æå‡äº†ç ”å‘æ•ˆç‡ã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³ç ”ç©¶äººå‘˜åœ¨å®ç°å¤æ‚ç®—æ³•æ—¶é¢ä¸´çš„æŒ‘æˆ˜ï¼Œå‡å°‘å¼€å‘å»¶è¿Ÿï¼Œå¹¶é¿å…é‡å¤æ€§ç¼–ç å·¥ä½œã€‚</p><p>DeepCode æ”¯æŒå¤šç§è¾“å…¥å½¢å¼ï¼ŒåŒ…æ‹¬å­¦æœ¯è®ºæ–‡ã€æ–‡æœ¬æç¤ºã€URL å’Œæ–‡æ¡£æ–‡ä»¶ï¼ˆå¦‚ PDFã€DOCã€PPTXã€TXTã€HTMLï¼‰ï¼Œå¹¶èƒ½ç”Ÿæˆé«˜è´¨é‡ã€å¯æ‰©å±•ä¸”åŠŸèƒ½ä¸°å¯Œçš„ä»£ç ã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œæ¶æ„ï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„å¼€å‘ä»»åŠ¡ï¼Œä»æ¦‚å¿µåˆ°å¯éƒ¨ç½²çš„åº”ç”¨ç¨‹åºã€‚</p><pre class=mermaid>
  flowchart LR
A[&#34;ğŸ“„ ç ”ç©¶è®ºæ–‡&lt;br/&gt;ğŸ’¬ æ–‡æœ¬æç¤º&lt;br/&gt;ğŸŒ URLs &amp; æ–‡æ¡£&lt;br/&gt;ğŸ“ æ–‡ä»¶: PDF, DOC, PPTX, TXT, HTML&#34;] --&gt; B[&#34;ğŸ§  DeepCode&lt;br/&gt;å¤šæ™ºèƒ½ä½“å¼•æ“&#34;]
B --&gt; C[&#34;ğŸš€ ç®—æ³•å®ç° &lt;br/&gt;ğŸ¨ å‰ç«¯å¼€å‘ &lt;br/&gt;âš™ï¸ åç«¯å¼€å‘&#34;]
style A fill:#ff6b6b,stroke:#c0392b,stroke-width:2px,color:#000
style B fill:#00d4ff,stroke:#0984e3,stroke-width:3px,color:#000
style C fill:#00b894,stroke:#00a085,stroke-width:2px,color:#000
</pre><h2 id=å…¥å£>å…¥å£</h2><p>è¦è¯»æ‡‚å…¨æµç¨‹ï¼Œå…ˆæ‰¾å…¥å£ï¼Œå¼€å§‹äºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python cli/main_cli.py --file paper.pdf
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹<code>cli/main_cli.py</code>ã€‚</p><p>æ‰¾åˆ°mainå‡½æ•°ï¼Œè·³è¿‡ç¯å¢ƒæ£€æŸ¥ç­‰ç­‰ï¼Œä½ ä¼šå‘ç°æœ€æ ¸å¿ƒçš„åœ°æ–¹åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>file</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>url</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>chat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># éªŒè¯æ–‡ä»¶å­˜åœ¨</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>FAIL</span><span class=si>}</span><span class=s2>âŒ File not found: </span><span class=si>{</span><span class=n>args</span><span class=o>.</span><span class=n>file</span><span class=si>}{</span><span class=n>Colors</span><span class=o>.</span><span class=n>ENDC</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>success</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_direct_processing</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>file</span><span class=p>,</span> <span class=s2>&#34;file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>args</span><span class=o>.</span><span class=n>url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>success</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_direct_processing</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>url</span><span class=p>,</span> <span class=s2>&#34;url&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>args</span><span class=o>.</span><span class=n>chat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># éªŒè¯chatè¾“å…¥é•¿åº¦</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>FAIL</span><span class=si>}</span><span class=s2>âŒ Chat input too short. Please provide more detailed requirements (at least 20 characters)</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>ENDC</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>success</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_direct_processing</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>chat</span><span class=p>,</span> <span class=s2>&#34;chat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span> <span class=k>if</span> <span class=n>success</span> <span class=k>else</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># äº¤äº’å¼æ¨¡å¼</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>CYAN</span><span class=si>}</span><span class=s2>ğŸ® Starting interactive mode...</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>ENDC</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>app</span><span class=o>.</span><span class=n>run_interactive_session</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦çœ‹<code>run_direct_processing</code>å‡½æ•°å°±okäº†</p><p>æ¥çœ‹ï¼šè¿™ä¸ªå‡½æ•°é‡Œçš„æ ¸å¿ƒä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆå§‹åŒ–åº”ç”¨</span>
</span></span><span class=line><span class=cl><span class=n>init_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>app</span><span class=o>.</span><span class=n>initialize_mcp_app</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>init_result</span><span class=p>[</span><span class=s2>&#34;status&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=s2>&#34;success&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>Colors</span><span class=o>.</span><span class=n>FAIL</span><span class=si>}</span><span class=s2>âŒ Initialization failed: </span><span class=si>{</span><span class=n>init_result</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span><span class=si>}{</span><span class=n>Colors</span><span class=o>.</span><span class=n>ENDC</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¤„ç†è¾“å…¥</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>app</span><span class=o>.</span><span class=n>process_input</span><span class=p>(</span><span class=n>input_source</span><span class=p>,</span> <span class=n>input_type</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¦å…³æ³¨çš„å…¶å®ä¹Ÿå°±æ˜¯ï¼š<code>app.initialize_mcp_app()</code>å’Œ<code>app.process_input(input_source, input_type)</code>ï¼Œè¿˜è®°å¾—input_sourceå’Œinput_typeå—ï¼Œinput_typeæœ‰chatã€urlã€fileï¼Œsourceå°±æ˜¯å¯¹åº”çš„å†…å®¹</p><p>é‚£æˆ‘ä»¬ä¸‹é¢åˆ†åˆ«æ¥çœ‹<code>app.initialize_mcp_app()</code>å’Œ<code>app.process_input(input_source, input_type)</code>ï¼Œè®°å½•ä¸€ä¸‹ç°åœ¨çš„taskList</p><hr><ul><li><input disabled type=checkbox> è¯»<code>app.initialize_mcp_app()</code></li><li><input disabled type=checkbox> è¯»<code>app.process_input(input_source, input_type)</code></li></ul><hr><h2 id=mcpéƒ¨åˆ†>mcpéƒ¨åˆ†</h2><p>æ¥çœ‹<code>app.initialize_mcp_app()</code>ï¼Œæœ€ç»ˆå®šä½åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>initialize_mcp_app</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;åˆå§‹åŒ–MCPåº”ç”¨ - ä½¿ç”¨å·¥ä½œæµé€‚é…å™¨&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Workflow adapter will handle MCP initialization</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>workflow_adapter</span><span class=o>.</span><span class=n>initialize_mcp_app</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥çœ‹<code>self.workflow_adapter.initialize_mcp_app()</code>ï¼Œæ ¸å¿ƒä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Initialize MCP application</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>app</span> <span class=o>=</span> <span class=n>MCPApp</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;cli_agent_orchestration&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>app_context</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>agent_app</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>app_context</span><span class=o>.</span><span class=fm>__aenter__</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>è¯¶ï¼ŸåŸæ¥ä¸æ˜¯åˆå§‹åŒ–mcpçš„é…ç½®ï¼Œè€Œæ˜¯ç›´æ¥åˆå§‹åŒ–äº†self.appä¹Ÿå°±æ˜¯æ ¸å¿ƒçš„agentï¼Œä»–è¿™é‡Œagentå°±å«åšmcp applicationï¼Œæ€»ä¹‹è¿™é‡Œå…ˆæŠŠcliçš„appåˆå§‹åŒ–æˆäº†cli_agent_orchestrationï¼Œå¯ä»¥ç»™å¤§å®¶çœ‹ä¸€ä¸‹è¿™è¾¹agentçš„æ¶æ„å›¾ï¼š</p><pre class=mermaid>
  graph TB
subgraph &#34;æ™ºèƒ½ä½“å±‚&#34;
CO[ä¸­å¤®åè°ƒæ™ºèƒ½ä½“]
IU[æ„å›¾ç†è§£æ™ºèƒ½ä½“]
DP[æ–‡æ¡£è§£ææ™ºèƒ½ä½“]
CP[ä»£ç è§„åˆ’æ™ºèƒ½ä½“]
CR[ä»£ç å‚è€ƒæŒ–æ˜æ™ºèƒ½ä½“]
CI[ä»£ç ç”Ÿæˆæ™ºèƒ½ä½“]
end
subgraph &#34;MCPæœåŠ¡å™¨å±‚&#34;
DS[document-segmentation]
FI[filesystem]
BR[brave]
GH[github-downloader]
CI_S[command-executor]
CI_I[Code Implementation Server]
end
CO --&gt; |è°ƒåº¦| IU
CO --&gt; |è°ƒåº¦| DP
CO --&gt; |è°ƒåº¦| CP
CO --&gt; |è°ƒåº¦| CR
CO --&gt; |è°ƒåº¦| CI
DP --&gt; |è°ƒç”¨| DS
CR --&gt; |è°ƒç”¨| BR
CR --&gt; |è°ƒç”¨| GH
CI --&gt; |è°ƒç”¨| FI
CI --&gt; |è°ƒç”¨| CI_S
CI --&gt; |è°ƒç”¨| CI_I
</pre><p>åˆšåˆšåˆå§‹åŒ–çš„å°±æ˜¯ä¸­å¤®åè°ƒæ™ºèƒ½ä½“ï¼Œè®©æˆ‘ä»¬æ›´æ–°ä¸€ä¸‹tasklist</p><hr><ul><li><input checked disabled type=checkbox> è¯»<code>app.initialize_mcp_app()</code></li><li><input disabled type=checkbox> è¯»<code>app.process_input(input_source, input_type)</code></li></ul><hr><p>é‚£æˆ‘ä»¬æ¥ç€æ¥çœ‹ï¼š<code>app.process_input(input_source, input_type)</code></p><h2 id=appprocess_inputinput_source-input_type>app.process_input(input_source, input_type)</h2><p>è¿™é‡Œæœ‰æ®µæŒºå¥‡æ€ªçš„ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Update segmentation configuration before processing</span>
</span></span><span class=line><span class=cl><span class=c1># åœ¨å¤„ç†ä¹‹å‰æ›´æ–°segmentation configuration</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>update_segmentation_config</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹ä¸‹è¿™ä¸ªå‡½æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_segmentation_config</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Update document segmentation configuration in mcp_agent.config.yaml&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>yaml</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>config_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;mcp_agent.config.yaml&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Read current config</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>config_path</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>config</span> <span class=o>=</span> <span class=n>yaml</span><span class=o>.</span><span class=n>safe_load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Update document segmentation settings</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;document_segmentation&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>config</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>config</span><span class=p>[</span><span class=s2>&#34;document_segmentation&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>config</span><span class=p>[</span><span class=s2>&#34;document_segmentation&#34;</span><span class=p>][</span><span class=s2>&#34;enabled&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>segmentation_config</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;enabled&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>config</span><span class=p>[</span><span class=s2>&#34;document_segmentation&#34;</span><span class=p>][</span><span class=s2>&#34;size_threshold_chars&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>segmentation_config</span><span class=p>[</span><span class=s2>&#34;size_threshold_chars&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Write updated config</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>config_path</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>yaml</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>default_flow_style</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>allow_unicode</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cli</span><span class=o>.</span><span class=n>print_status</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ğŸ“„ Document segmentation configuration updated&#34;</span><span class=p>,</span> <span class=s2>&#34;success&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cli</span><span class=o>.</span><span class=n>print_status</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;âš ï¸ Failed to update segmentation config: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å‘ç°å…¶å®å°±æ˜¯å…ˆåŠ è½½é…ç½®ï¼Œç„¶ååŒæ­¥cliçš„é…ç½®</p><p>å†å›æ¥çœ‹ï¼Œç„¶åè¿™ä¸ªå‡½æ•°çš„æ ¸å¿ƒå°±åœ¨äºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ä½¿ç”¨å·¥ä½œæµé€‚é…å™¨è¿›è¡Œå¤„ç†</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>workflow_adapter</span><span class=o>.</span><span class=n>process_input_with_orchestration</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>input_source</span><span class=o>=</span><span class=n>input_source</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>input_type</span><span class=o>=</span><span class=n>input_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>enable_indexing</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>cli</span><span class=o>.</span><span class=n>enable_indexing</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿›åˆ°è¿™ä¸ªå‡½æ•°é‡Œçœ‹çœ‹ï¼Œå‰é¢éƒ½æ˜¯é¢„å¤„ç†ï¼Œæœ€æ ¸å¿ƒçš„ä»£ç åœ¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Execute appropriate pipeline based on input type</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>input_type</span> <span class=o>==</span> <span class=s2>&#34;chat&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Use chat-based planning pipeline for user requirements</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline_result</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>execute_chat_pipeline</span><span class=p>(</span><span class=n>input_source</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Use traditional multi-agent research pipeline for files/URLs</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline_result</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>execute_full_pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>input_source</span><span class=p>,</span> <span class=n>enable_indexing</span><span class=o>=</span><span class=n>enable_indexing</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹fileå’Œurlä¸‹çš„å…¨æµç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çœ‹ä¸‹<code>self.execute_full_pipeline</code>å°±è¡Œäº†ï¼Œæ›´æ–°ä¸€ä¸‹tasklist</p><hr><ul><li><input checked disabled type=checkbox> è¯»<code>app.initialize_mcp_app()</code></li><li><input checked disabled type=checkbox> è¯»<code>app.process_input(input_source, input_type)</code></li></ul><hr><p>å¹¶è¡Œä»»åŠ¡ç»“æŸäº†ï¼Œæˆ‘ä»¬ä¸‹é¢æ¥è¯»<code>self.execute_full_pipeline</code>ã€‚</p><h2 id=selfexecute_full_pipeline>self.execute_full_pipeline</h2><p>è¯»ä¸€ä¸‹å‘ç°è¿™ä¸ªå‡½æ•°æœ€æ ¸å¿ƒçš„åœ°æ–¹å°±åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>execute_multi_agent_research_pipeline</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>input_source</span><span class=o>=</span><span class=n>input_source</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>progress_callback</span><span class=o>=</span><span class=n>progress_callback</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>enable_indexing</span><span class=o>=</span><span class=n>enable_indexing</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é‚£æˆ‘ä»¬è¿›åˆ°<code>execute_multi_agent_research_pipeline</code>é‡Œï¼Œå¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬ç¦»æ ¸å¿ƒä»£ç è¶Šæ¥è¶Šè¿‘äº†</p><h2 id=execute_multi_agent_research_pipeline>execute_multi_agent_research_pipeline</h2><p>å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„æ³¨é‡Šå§ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Execute the complete intelligent multi-agent research orchestration pipeline.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This is the main AI orchestration engine that coordinates autonomous research workflow agents:
</span></span><span class=line><span class=cl>- Local workspace automation for seamless environment management
</span></span><span class=line><span class=cl>- Intelligent research analysis with automated content processing
</span></span><span class=line><span class=cl>- AI-driven code architecture synthesis and design automation
</span></span><span class=line><span class=cl>- Reference intelligence discovery with automated knowledge extraction (optional)
</span></span><span class=line><span class=cl>- Codebase intelligence orchestration with automated relationship analysis (optional)
</span></span><span class=line><span class=cl>- Intelligent code implementation synthesis with AI-powered development
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘æ¥å–½ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>æ‰§è¡Œå®Œæ•´çš„æ™ºèƒ½å¤šæ™ºèƒ½ä½“ç ”ç©¶ç¼–æ’æµç¨‹ã€‚ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¿™æ˜¯åè°ƒè‡ªä¸»ç ”ç©¶å·¥ä½œæµæ™ºèƒ½ä½“çš„ä¸»è¦AIç¼–æ’å¼•æ“ï¼ŒåŒ…æ‹¬ï¼š 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- æœ¬åœ°å·¥ä½œåŒºè‡ªåŠ¨åŒ–ï¼Œå®ç°æ— ç¼ç¯å¢ƒç®¡ç†
</span></span><span class=line><span class=cl>- æ™ºèƒ½ç ”ç©¶åˆ†æï¼Œç»“åˆè‡ªåŠ¨åŒ–å†…å®¹å¤„ç†
</span></span><span class=line><span class=cl>- AIé©±åŠ¨çš„ä»£ç æ¶æ„ç»¼åˆä¸è®¾è®¡è‡ªåŠ¨åŒ–
</span></span><span class=line><span class=cl>- å‚è€ƒæ™ºèƒ½å‘ç°ï¼Œç»“åˆè‡ªåŠ¨åŒ–çŸ¥è¯†æå–ï¼ˆå¯é€‰ï¼‰
</span></span><span class=line><span class=cl>- ä»£ç åº“æ™ºèƒ½ç¼–æ’ï¼Œç»“åˆè‡ªåŠ¨åŒ–å…³ç³»åˆ†æï¼ˆå¯é€‰ï¼‰
</span></span><span class=line><span class=cl>- æ™ºèƒ½ä»£ç å®ç°ç»¼åˆï¼Œç»“åˆAIé©±åŠ¨çš„å¼€å‘
</span></span></code></pre></td></tr></table></div></div><p>é‚£æˆ‘ä»¬ç»§ç»­å¾€ä¸‹è¯»ä»£ç ï¼š</p><p>æºä»£ç ä¸‹é¢çš„éƒ¨åˆ†åˆ—çš„ä¹Ÿæ¯”è¾ƒè¯¦ç»†ï¼Œåˆ†äº†phase 0ã€1ã€2ã€3ï¼Œæˆ‘ä»¬ä¹Ÿè·Ÿç€å®ƒçš„æ€è·¯æ¥çœ‹</p><h3 id=phase0>phase0</h3><p>phase0æ˜¯åˆå§‹åŒ–å·¥ä½œåŒºï¼Œæ ¸å¿ƒä»£ç æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Setup local workspace directory</span>
</span></span><span class=line><span class=cl><span class=n>workspace_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>(),</span> <span class=s2>&#34;deepcode_lab&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>workspace_dir</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶å®å°±æ˜¯æ–°å»ºäº†æ–‡ä»¶å¤¹<code>deepcode_lab</code></p><h3 id=phase1>phase1</h3><p>å¤„ç†å’ŒéªŒè¯è¾“å…¥ï¼Œè®©æˆ‘ä»¬è¿›æ¥çœ‹ï¼š<code>_process_input_source</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>input_source</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;file://&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>file_path</span> <span class=o>=</span> <span class=n>input_source</span><span class=p>[</span><span class=mi>7</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;nt&#34;</span> <span class=ow>and</span> <span class=n>file_path</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>file_path</span> <span class=o>=</span> <span class=n>file_path</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>file_path</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>input_source</span>
</span></span></code></pre></td></tr></table></div></div><p>å‘ç°åªæ˜¯æŠŠ<code>file://</code>å¼€å¤´çš„æ–‡ä»¶ç›®å½•æ”¹æˆäº†æ­£å¸¸çš„æ–‡ä»¶ç›®å½•ï¼Œç»§ç»­çœ‹phase2</p><h3 id=phase2>phase2</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Phase 2: Research Analysis and Resource Processing (if needed)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>input_source</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>input_source</span><span class=o>.</span><span class=n>endswith</span><span class=p>((</span><span class=s2>&#34;.pdf&#34;</span><span class=p>,</span> <span class=s2>&#34;.docx&#34;</span><span class=p>,</span> <span class=s2>&#34;.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;.html&#34;</span><span class=p>,</span> <span class=s2>&#34;.md&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=ow>or</span> <span class=n>input_source</span><span class=o>.</span><span class=n>startswith</span><span class=p>((</span><span class=s2>&#34;http&#34;</span><span class=p>,</span> <span class=s2>&#34;file://&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>analysis_result</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>download_result</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=o>=</span> <span class=k>await</span> <span class=n>orchestrate_research_analysis_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>input_source</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=n>progress_callback</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>download_result</span> <span class=o>=</span> <span class=n>input_source</span>  <span class=c1># Use input directly if already processed</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸€æ®µä¸»è¦æ˜¯è§£æ<code>input_source</code>ï¼Œå¦‚æœä»–æ˜¯æ–‡ä»¶æˆ–è€…urlå°±è¿è¡Œ<code>orchestrate_research_analysis_agent</code>è·å–<code>analysis_result</code>å’Œ<code>download_result</code>ï¼Œå¦‚æœéƒ½ä¸æ˜¯å°±ç›´æ¥ä½œä¸ºè¾“å…¥å†…å®¹ï¼Œä½œä¸ºè¾“å…¥å†…å®¹å¯èƒ½æ˜¯ä¸ºäº†chatè®¾è®¡çš„ï¼Œæˆ‘ä»¬è¿›æ¥çœ‹<code>orchestrate_research_analysis_agent</code>ã€‚</p><h4 id=orchestrate_research_analysis_agent>orchestrate_research_analysis_agent</h4><p>è€æ ·å­ï¼Œå…ˆçœ‹æ³¨é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Orchestrate intelligent research analysis and resource processing automation.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This agent coordinates multiple AI components to analyze research content
</span></span><span class=line><span class=cl>and process associated resources with automated workflow management.
</span></span></code></pre></td></tr></table></div></div><p>ä¸­æ–‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ç¼–æ’æ™ºèƒ½ç ”ç©¶åˆ†æä¸èµ„æºå¤„ç†è‡ªåŠ¨åŒ–ã€‚ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>æ­¤æ™ºèƒ½ä½“åè°ƒå¤šä¸ªAIç»„ä»¶ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–å·¥ä½œæµç®¡ç†ï¼Œä»¥åˆ†æç ”ç©¶å†…å®¹å¹¶å¤„ç†ç›¸å…³èµ„æºã€‚ 
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸€æ®µç®—æ˜¯è¯¥é¡¹ç›®ä¸­ç›¸å½“é‡è¦çš„ä¸€éƒ¨åˆ†äº†ï¼Œè§£æpdfèµ„æºä¹Ÿæ˜¯æˆ‘éå¸¸å¥½å¥‡å®ƒå¦‚ä½•å¤„ç†çš„åœ°æ–¹ï¼Œåé¢å¦‚æœæœ‰å¤„ç†èµ„æºçš„éƒ¨åˆ†æˆ‘ä»¬ä¹Ÿåªæ¥çœ‹pdfèµ„æºçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸å»çœ‹å…¶ä»–è§£æäº†ï¼Œå¤§å®¶å¥½å¥‡çš„å¯ä»¥è‡ªå·±å»è¯»</p><p>é¦–å…ˆæ¥çœ‹ç¬¬ä¸€æ­¥ï¼Œè¿™ä¸€æ­¥çš„æ ¸å¿ƒä»£ç æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>analysis_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_research_analyzer</span><span class=p>(</span><span class=n>input_source</span><span class=p>,</span> <span class=n>logger</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é‚£æˆ‘ä»¬ç›´æ¥è¿›æ¥çœ‹<code>run_research_analyzer</code></p><p>æ‰æ³¨æ„åˆ°<code>prompt_text</code>è¿˜æ˜¯<code>input_source</code>ï¼Œé‚£è¿™ä¸ªæ˜¯ç±»ä¼¼äºdeep researchçš„agentï¼Ÿæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š</p><p>å¥½ï¼Œä¸‹é¢åˆå§‹åŒ–äº†ä¸€ä¸ªæ–°æ™ºèƒ½ä½“ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>analyzer_agent</span> <span class=o>=</span> <span class=n>Agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=s2>&#34;ResearchAnalyzerAgent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>instruction</span><span class=o>=</span><span class=n>PAPER_INPUT_ANALYZER_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>server_names</span><span class=o>=</span><span class=n>get_search_server_names</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å…ˆæ¥çœ‹Agentç±»ï¼Œ<code>name</code>ã€<code>instruction</code>ã€<code>server_names</code>çš„æ³¨é‡Š</p><p><code>name</code> : <code>Agent name.</code></p><p><code>instruction</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Instruction for the agent. This can be a string or a callable that takes a dictionary
</span></span><span class=line><span class=cl>and returns a string. The callable can be used to generate dynamic instructions based
</span></span><span class=line><span class=cl>on the context.
</span></span><span class=line><span class=cl>æ™ºèƒ½ä½“çš„æŒ‡ä»¤ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ¥æ”¶ä¸€ä¸ªå­—å…¸å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¯¥å¯è°ƒç”¨å¯¹è±¡å¯ç”¨äºæ ¹æ®ä¸Šä¸‹æ–‡ç”ŸæˆåŠ¨æ€æŒ‡ä»¤ã€‚
</span></span></code></pre></td></tr></table></div></div><p><code>server_names</code> : <code>List of MCP server names that the agent can access.</code>ï¼Œå¥¥è¿™ä¸ªå°±æ˜¯mcpæœåŠ¡å™¨çš„é…ç½®ï¼Œé‚£æˆ‘ä»¬å…ˆæ¥å¥½å¥½è¯»è¯»ï¼š<code>PAPER_INPUT_ANALYZER_PROMPT</code></p><p><code>PAPER_INPUT_ANALYZER_PROMPT</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>You</span> <span class=n>are</span> <span class=n>a</span> <span class=n>precise</span> <span class=n>input</span> <span class=n>analyzer</span> <span class=k>for</span> <span class=n>paper</span><span class=o>-</span><span class=n>to</span><span class=o>-</span><span class=n>code</span> <span class=n>tasks</span><span class=o>.</span> <span class=n>You</span> <span class=n>MUST</span> <span class=k>return</span> <span class=n>only</span> <span class=n>a</span> <span class=n>JSON</span> <span class=n>object</span> <span class=n>with</span> <span class=n>no</span> <span class=n>additional</span> <span class=n>text</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Task</span><span class=p>:</span> <span class=n>Analyze</span> <span class=n>input</span> <span class=n>text</span> <span class=ow>and</span> <span class=n>identify</span> <span class=n>file</span> <span class=n>paths</span><span class=o>/</span><span class=n>URLs</span> <span class=n>to</span> <span class=n>determine</span> <span class=n>appropriate</span> <span class=n>input</span> <span class=n>type</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=ne>Input</span> <span class=n>Analysis</span> <span class=n>Rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=ne>Path</span> <span class=n>Detection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Scan</span> <span class=n>input</span> <span class=n>text</span> <span class=k>for</span> <span class=n>file</span> <span class=n>paths</span> <span class=ow>or</span> <span class=n>URLs</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Use</span> <span class=n>first</span> <span class=n>valid</span> <span class=n>path</span><span class=o>/</span><span class=n>URL</span> <span class=k>if</span> <span class=n>multiple</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Treat</span> <span class=n>as</span> <span class=n>text</span> <span class=n>input</span> <span class=k>if</span> <span class=n>no</span> <span class=n>valid</span> <span class=n>path</span><span class=o>/</span><span class=n>URL</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=ne>Path</span> <span class=n>Type</span> <span class=n>Classification</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>URL</span> <span class=p>(</span><span class=n>starts</span> <span class=n>with</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span> <span class=ow>or</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=p>):</span> <span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;url&#34;</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=s2>&#34;detected URL&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>PDF</span> <span class=n>file</span> <span class=n>path</span><span class=p>:</span> <span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;file&#34;</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=s2>&#34;detected file path&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=ne>Directory</span> <span class=n>path</span><span class=p>:</span> <span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;directory&#34;</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=s2>&#34;detected directory path&#34;</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>No</span> <span class=n>path</span><span class=o>/</span><span class=n>URL</span> <span class=n>detected</span><span class=p>:</span> <span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=n>Requirements</span> <span class=n>Analysis</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Extract</span> <span class=n>ONLY</span> <span class=n>requirements</span> <span class=n>from</span> <span class=n>additional_input</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>DO</span> <span class=n>NOT</span> <span class=n>modify</span> <span class=ow>or</span> <span class=n>interpret</span> <span class=n>requirements</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>CRITICAL</span> <span class=n>OUTPUT</span> <span class=n>RESTRICTIONS</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>RETURN</span> <span class=n>ONLY</span> <span class=n>RAW</span> <span class=n>JSON</span> <span class=o>-</span> <span class=n>NO</span> <span class=n>TEXT</span> <span class=n>BEFORE</span> <span class=n>OR</span> <span class=n>AFTER</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>NO</span> <span class=n>markdown</span> <span class=n>code</span> <span class=n>blocks</span> <span class=p>(</span><span class=err>```</span><span class=n>json</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>NO</span> <span class=n>explanatory</span> <span class=n>text</span> <span class=ow>or</span> <span class=n>descriptions</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>NO</span> <span class=k>tool</span> <span class=n>call</span> <span class=n>information</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>NO</span> <span class=n>analysis</span> <span class=n>summaries</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>JUST</span> <span class=n>THE</span> <span class=n>JSON</span> <span class=n>OBJECT</span> <span class=n>BELOW</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;text|file|directory|url&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;detected path or URL or null&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;N/A for text input&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;exact requirement from additional_input&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸­æ–‡ç‰ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ä½ æ˜¯è®ºæ–‡åˆ°ä»£ç ä»»åŠ¡çš„ç²¾å‡†è¾“å…¥åˆ†æå‘˜ã€‚ä½ å¿…é¡»åªè¿”å› JSON å¯¹è±¡ï¼Œä¸åŒ…å«ä»»ä½•é™„åŠ æ–‡æœ¬ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ä»»åŠ¡ï¼šåˆ†æè¾“å…¥æ–‡æœ¬å¹¶è¯†åˆ«æ–‡ä»¶è·¯å¾„/URLï¼Œä»¥ç¡®å®šåˆé€‚çš„è¾“å…¥ç±»å‹ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¾“å…¥åˆ†æè§„åˆ™ï¼š
</span></span><span class=line><span class=cl>1. è·¯å¾„æ£€æµ‹ï¼š
</span></span><span class=line><span class=cl>- æ‰«æè¾“å…¥æ–‡æœ¬ä¸­çš„æ–‡ä»¶è·¯å¾„æˆ– URL
</span></span><span class=line><span class=cl>- å¦‚æœæ‰¾åˆ°å¤šä¸ªï¼Œåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªæœ‰æ•ˆçš„è·¯å¾„/URL
</span></span><span class=line><span class=cl>- å¦‚æœæœªæ‰¾åˆ°æœ‰æ•ˆçš„è·¯å¾„/URLï¼Œåˆ™è§†ä¸ºæ–‡æœ¬è¾“å…¥
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. è·¯å¾„ç±»å‹åˆ†ç±»ï¼š
</span></span><span class=line><span class=cl>- URLï¼ˆä»¥ http:// æˆ– https:// å¼€å¤´ï¼‰ï¼šinput_type = &#34;url&#34;, path = &#34;æ£€æµ‹åˆ°çš„ URL&#34;
</span></span><span class=line><span class=cl>- PDF æ–‡ä»¶è·¯å¾„ï¼šinput_type = &#34;file&#34;, path = &#34;æ£€æµ‹åˆ°çš„æ–‡ä»¶è·¯å¾„&#34;
</span></span><span class=line><span class=cl>- ç›®å½•è·¯å¾„ï¼šinput_type = &#34;directory&#34;, path = &#34;æ£€æµ‹åˆ°çš„ç›®å½•è·¯å¾„&#34;
</span></span><span class=line><span class=cl>- æœªæ£€æµ‹åˆ°è·¯å¾„/URLï¼šinput_type = &#34;text&#34;, path = null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. éœ€æ±‚åˆ†æï¼š
</span></span><span class=line><span class=cl>- ä»…ä» additional_input ä¸­æå–éœ€æ±‚
</span></span><span class=line><span class=cl>- è¯·å‹¿ä¿®æ”¹æˆ–è§£é‡Šéœ€æ±‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>å…³é”®è¾“å‡ºé™åˆ¶ï¼š
</span></span><span class=line><span class=cl>- ä»…è¿”å›åŸå§‹ JSON - å‰åå‡æ— æ–‡æœ¬
</span></span><span class=line><span class=cl>- ä¸åŒ…å« Markdown ä»£ç å— (```json)
</span></span><span class=line><span class=cl>- ä¸åŒ…å«è§£é‡Šæ€§æ–‡æœ¬æˆ–æè¿°
</span></span><span class=line><span class=cl>- ä¸åŒ…å«å·¥å…·è°ƒç”¨ä¿¡æ¯
</span></span><span class=line><span class=cl>- ä¸åŒ…å«åˆ†ææ‘˜è¦
</span></span><span class=line><span class=cl>- ä»…åŒ…å«ä¸‹é¢çš„ JSON å¯¹è±¡
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>&#34;input_type&#34;: &#34;text|file|directory|url&#34;,
</span></span><span class=line><span class=cl>&#34;path&#34;: &#34;æ£€æµ‹åˆ°çš„è·¯å¾„æˆ– URL æˆ– null&#34;,
</span></span><span class=line><span class=cl>&#34;paper_info&#34;: {
</span></span><span class=line><span class=cl>&#34;title&#34;: &#34;æ–‡æœ¬è¾“å…¥ä¸é€‚ç”¨&#34;,
</span></span><span class=line><span class=cl>&#34;authors&#34;: [&#34;æ–‡æœ¬è¾“å…¥ä¸é€‚ç”¨&#34;],
</span></span><span class=line><span class=cl>&#34;year&#34;: &#34;æ–‡æœ¬è¾“å…¥ä¸é€‚ç”¨&#34;
</span></span><span class=line><span class=cl>},
</span></span><span class=line><span class=cl>&#34;requirements&#34;: [
</span></span><span class=line><span class=cl>&#34;additional_input çš„ç¡®åˆ‡è¦æ±‚&#34;
</span></span><span class=line><span class=cl>]
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªå°±æ˜¯åˆ†æinput_sourceçš„ç±»å‹å’Œä¿¡æ¯ï¼Œé‚£ç„æœºå…¶å®åœ¨mcpæœåŠ¡å™¨é‡Œï¼š<code>get_search_server_names()</code>ï¼Œæˆ‘ä»¬è¿›æ¥çœ‹çœ‹è¿™ä¸ªï¼Œèƒ½ç”¨å“ªäº›search_mcp</p><p>ç„¶åå‘ç°æ˜¯ç”¨äº†ï¼šbraveï¼Œä¹Ÿå°±æ˜¯<code>@modelcontextprotocol/server-brave-search</code>ï¼Œæˆ‘ä»¬è¿™é‡Œä¸è¯»è¿™ä¸ªï¼Œå°±æ¥çœ‹çœ‹braveèƒ½å¹²ä»€ä¹ˆã€‚</p><p>ç„¶åå‘ç°æ˜¯ä¿¡æ¯æœç´¢ï¼Œè¯»åˆ°è¿™é‡Œæˆ‘è§‰å¾—æŒºå¥‡æ€ªçš„ï¼Œç„¶åæˆ‘å°±åœ¨<code>agent_orchestration_engine.py</code>çš„ç¬¬250è¡ŒåŠ äº†å¦‚ä¸‹ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;test.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>raw_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åç”¨<code>uv run cli/main_cli.py --file test.pdf</code>è·‘äº†ä¸€ä¸‹ï¼Œæœç„¶è·Ÿæˆ‘æƒ³çš„ä¸€æ ·ï¼Œ<code>test.txt</code>é‡Œæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;file&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;test.pdf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;N/A for text input&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘æƒ³è¿™ä¸ªpaper_infoæ˜¯æ€ä¹ˆå–å‡ºæ¥çš„ç™¾æ€ä¸å¾—å…¶è§£ï¼Œè·‘äº†ä¸€éå‘ç°ç¡®å®å–ä¸å‡ºæ¥ï¼Œæˆ‘çŒœè¿™é‡Œæ˜¯ä¸ºäº†æå‰ç•™ä¸ªç»“æ„ç»™åé¢ç”¨ï¼Œç»·ï¼Œæ‰€ä»¥è¿™ä¸ªagentçš„æ ¸å¿ƒå…¶å®å°±åœ¨åˆ†å¼€urlå’Œfileï¼Œç„¶ååŒºåˆ†äº†ä¸€ä¸‹æ–‡ä»¶ç±»å‹ï¼Œè¯´å®è¯è¿™ä¸€æ­¥æ„Ÿè§‰å®Œå…¨æ²¡å¿…è¦ï¼Œæ„Ÿè§‰æ˜¯ä¸ºäº†é˜²è ¢ç”¨çš„ï¼ˆ</p><p>å¥½æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ï¼Œä¸‹é¢çš„é‡ç‚¹åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Clean LLM output to ensure only pure JSON is returned</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clean_result</span> <span class=o>=</span> <span class=n>extract_clean_json</span><span class=p>(</span><span class=n>raw_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Raw LLM output: </span><span class=si>{</span><span class=n>raw_result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cleaned JSON output: </span><span class=si>{</span><span class=n>clean_result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ª<code>extract_clean_json</code>æ˜¯æ‹¿æ¥<code>Extract clean JSON from LLM output, removing all extra text and formatting.</code>ï¼Œä¹Ÿå°±æ˜¯ä»å¤§è¯­è¨€æ¨¡å‹è¾“å‡ºä¸­æå–è§„æ•´çš„JSONï¼Œå»é™¤æ‰€æœ‰å¤šä½™çš„æ–‡æœ¬å’Œæ ¼å¼ã€‚</p><p>æ¯”å¦‚å¦‚æœå¤§å®¶ç»å¸¸åšllmç›¸å…³åº”ç”¨çš„è¯ï¼Œå¯èƒ½é‡åˆ°è¿‡ä¸æ˜¯çº¯jsonæ–‡æœ¬è¾“å‡ºçš„æƒ…å†µï¼Œæ€ä¹ˆé™åˆ¶éƒ½æ²¡ç”¨ï¼Œç”¨è¿™ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥æå–jsonå‡ºæ¥</p><p>å…·ä½“å®ç°æ­¥éª¤æˆ‘å†™åœ¨æ³¨é‡Šé‡Œäº†ï¼Œå¤§å®¶ç›´æ¥çœ‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_clean_json</span><span class=p>(</span><span class=n>llm_output</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Extract clean JSON from LLM output, removing all extra text and formatting.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        llm_output: Raw LLM output
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        str: Clean JSON string
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># é¦–å…ˆå°è¯•å»æ‰ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦è¡Œä¸è¡Œ</span>
</span></span><span class=line><span class=cl>        <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>llm_output</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>llm_output</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ç„¶åç”¨æ­£åˆ™è¯•è¯•å–```json ```ä¸­é—´çš„å†…å®¹</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;```json&#34;</span> <span class=ow>in</span> <span class=n>llm_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;```json\s*(.*?)\s*```&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>llm_output</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json_text</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>json_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>json_text</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ ¹æ®æ‰‹åŠ¨åŒ¹é…èŠ±æ‹¬å·çš„æ–¹æ³•æ¥å–å‡ºjson</span>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>llm_output</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>json_lines</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>in_json</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=n>brace_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>stripped</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>in_json</span> <span class=ow>and</span> <span class=n>stripped</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;{&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>in_json</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=n>json_lines</span> <span class=o>=</span> <span class=p>[</span><span class=n>line</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>brace_count</span> <span class=o>=</span> <span class=n>stripped</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s2>&#34;{&#34;</span><span class=p>)</span> <span class=o>-</span> <span class=n>stripped</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>in_json</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json_lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>brace_count</span> <span class=o>+=</span> <span class=n>stripped</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s2>&#34;{&#34;</span><span class=p>)</span> <span class=o>-</span> <span class=n>stripped</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>brace_count</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>json_lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>json_text</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>json_lines</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>json_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json_text</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æœ€åå°è¯•ç”¨æ­£åˆ™å–å‡ºjson</span>
</span></span><span class=line><span class=cl>    <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;\{[^</span><span class=si>{}</span><span class=s2>]*(?:\{[^</span><span class=si>{}</span><span class=s2>]*\}[^</span><span class=si>{}</span><span class=s2>]*)*\}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>matches</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>llm_output</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=k>match</span> <span class=ow>in</span> <span class=n>matches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=k>match</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>match</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># If all methods fail, return original output</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>llm_output</span>
</span></span></code></pre></td></tr></table></div></div><p>å¥½äº†ï¼Œæˆ‘ä»¬æŠŠ<code>run_research_analyzer</code>çœ‹å®Œäº†ï¼Œå¤§å®¶è®°å¾—æˆ‘ä»¬ä»å“ªæ¥çš„å˜›ï¼Œè®©æˆ‘ä»¬å›åˆ°<code>orchestrate_research_analysis_agent</code></p><p>åˆšåˆšçœ‹çš„æ˜¯step 1ï¼Œè®©æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹step 2</p><p>æ ¸å¿ƒçš„ä»£ç æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>download_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_resource_processor</span><span class=p>(</span><span class=n>analysis_result</span><span class=p>,</span> <span class=n>logger</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬è¿›æ¥çœ‹<code>run_resource_processor</code>ï¼Œè¿™ä¸ªå‡½æ•°æŒºç®€å•çš„ï¼Œæˆ‘ä»¬æœ‰è¯»ä¹‹å‰çš„agentçš„ç»éªŒï¼Œè¯»è¿™ä¸ªå°±å¾ˆè¿…é€Ÿäº†ï¼Œä¼ å…¥çš„æ˜¯æˆ‘ä»¬ä¹‹å‰ä¸Šä¸€ä¸ªagentçš„åˆ†æç»“æœï¼Œä¸è®°å¾—å¤§å®¶è¿˜è®°ä¸è®°å¾—äº†ï¼Œæ¥çœ‹çœ‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;file&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;test.pdf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;N/A for text input&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªagentçš„promptå’Œtools</p><p>é¦–å…ˆæ˜¯prompt</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>You</span> <span class=n>are</span> <span class=n>a</span> <span class=n>precise</span> <span class=n>paper</span> <span class=n>downloader</span> <span class=n>that</span> <span class=n>processes</span> <span class=n>input</span> <span class=n>from</span> <span class=n>PaperInputAnalyzerAgent</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Task</span><span class=p>:</span> <span class=n>Handle</span> <span class=n>paper</span> <span class=n>according</span> <span class=n>to</span> <span class=n>input</span> <span class=n>type</span> <span class=ow>and</span> <span class=n>save</span> <span class=n>to</span> <span class=s2>&#34;./deepcode_lab/papers/id/id.md&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Note</span><span class=p>:</span> <span class=n>Generate</span> <span class=n>id</span> <span class=p>(</span><span class=n>id</span> <span class=n>is</span> <span class=n>a</span> <span class=n>number</span><span class=p>)</span> <span class=n>by</span> <span class=n>counting</span> <span class=n>files</span> <span class=ow>in</span> <span class=s2>&#34;./deepcode_lab/papers/&#34;</span> <span class=n>directory</span> <span class=ow>and</span> <span class=n>increment</span> <span class=n>by</span> <span class=mf>1.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>CRITICAL</span> <span class=n>RULE</span><span class=p>:</span> <span class=n>NEVER</span> <span class=n>use</span> <span class=n>write_file</span> <span class=k>tool</span> <span class=n>to</span> <span class=n>create</span> <span class=n>paper</span> <span class=n>content</span> <span class=n>directly</span><span class=o>.</span> <span class=n>Always</span> <span class=n>use</span> <span class=n>file</span><span class=o>-</span><span class=n>downloader</span> <span class=n>tools</span> <span class=k>for</span> <span class=n>PDF</span><span class=o>/</span><span class=n>document</span> <span class=n>conversion</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Processing</span> <span class=n>Rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>URL</span> <span class=ne>Input</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;url&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Use</span> <span class=s2>&#34;file-downloader&#34;</span> <span class=k>tool</span> <span class=n>to</span> <span class=n>download</span> <span class=n>paper</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Extract</span> <span class=n>metadata</span> <span class=p>(</span><span class=n>title</span><span class=p>,</span> <span class=n>authors</span><span class=p>,</span> <span class=n>year</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Return</span> <span class=n>saved</span> <span class=n>file</span> <span class=n>path</span> <span class=ow>and</span> <span class=n>metadata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=ne>File</span> <span class=ne>Input</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;file&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Move</span> <span class=n>file</span> <span class=n>to</span> <span class=s2>&#34;./deepcode_lab/papers/id/&#34;</span> <span class=n>using</span> <span class=n>move_file_to</span> <span class=k>tool</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>The</span> <span class=n>move_file_to</span> <span class=k>tool</span> <span class=n>will</span> <span class=n>automatically</span> <span class=nb>convert</span> <span class=n>PDF</span><span class=o>/</span><span class=n>documents</span> <span class=n>to</span> <span class=o>.</span><span class=n>md</span> <span class=n>format</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>NEVER</span> <span class=n>manually</span> <span class=n>extract</span> <span class=n>content</span> <span class=ow>or</span> <span class=n>use</span> <span class=n>write_file</span> <span class=o>-</span> <span class=n>let</span> <span class=n>the</span> <span class=n>conversion</span> <span class=n>tools</span> <span class=n>handle</span> <span class=n>this</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Return</span> <span class=n>new</span> <span class=n>saved</span> <span class=n>file</span> <span class=n>path</span> <span class=ow>and</span> <span class=n>metadata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=ne>Directory</span> <span class=ne>Input</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;directory&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Verify</span> <span class=n>directory</span> <span class=n>exists</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Return</span> <span class=n>to</span> <span class=n>PaperInputAnalyzerAgent</span> <span class=k>for</span> <span class=n>processing</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Set</span> <span class=n>status</span> <span class=n>as</span> <span class=s2>&#34;failure&#34;</span> <span class=n>with</span> <span class=n>message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=n>Text</span> <span class=ne>Input</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;text&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>No</span> <span class=n>file</span> <span class=n>operations</span> <span class=n>needed</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Set</span> <span class=n>paper_path</span> <span class=n>as</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Use</span> <span class=n>paper_info</span> <span class=n>from</span> <span class=n>input</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=ne>Input</span> <span class=n>Format</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;file|directory|url|text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;detected path or null&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;paper title or N/A&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;author names or N/A&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;publication year or N/A&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;requirement1&#34;</span><span class=p>,</span> <span class=s2>&#34;requirement2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Output</span> <span class=n>Format</span> <span class=p>(</span><span class=n>DO</span> <span class=n>NOT</span> <span class=n>MODIFY</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;success|failure&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_path&#34;</span><span class=p>:</span> <span class=s2>&#34;path to paper file or null for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;extracted or provided title&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;extracted or provided authors&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;extracted or provided year&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸­æ–‡ç¿»è¯‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>ä½ æ˜¯ä¸€ä¸ªç²¾å‡†çš„è®ºæ–‡ä¸‹è½½å™¨ï¼Œè´Ÿè´£å¤„ç†è¾“å…¥ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>ä»»åŠ¡ï¼šæ ¹æ®è¾“å…¥ç±»å‹å¤„ç†è®ºæ–‡å¹¶ä¿å­˜åˆ°â€œ</span><span class=o>./</span><span class=n>deepcode_lab</span><span class=o>/</span><span class=n>papers</span><span class=o>/</span><span class=n>id</span><span class=o>/</span><span class=n>id</span><span class=o>.</span><span class=n>md</span><span class=err>â€æ–‡ä»¶ã€‚</span>
</span></span><span class=line><span class=cl><span class=err>æ³¨æ„ï¼šé€šè¿‡ç»Ÿè®¡â€œ</span><span class=o>./</span><span class=n>deepcode_lab</span><span class=o>/</span><span class=n>papers</span><span class=o>/</span><span class=err>â€ç›®å½•ä¸­çš„æ–‡ä»¶æ•°é‡å¹¶åŠ </span> <span class=mi>1</span> <span class=err>æ¥ç”Ÿæˆ</span> <span class=n>ID</span><span class=err>ï¼ˆ</span><span class=n>id</span> <span class=err>ä¸ºæ•°å­—ï¼‰ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>å…³é”®è§„åˆ™ï¼šåˆ‡å‹¿ä½¿ç”¨</span> <span class=n>write_file</span> <span class=err>å·¥å…·ç›´æ¥åˆ›å»ºè®ºæ–‡å†…å®¹ã€‚åŠ¡å¿…ä½¿ç”¨æ–‡ä»¶ä¸‹è½½å·¥å…·è¿›è¡Œ</span> <span class=n>PDF</span><span class=o>/</span><span class=err>æ–‡æ¡£è½¬æ¢ã€‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>å¤„ç†è§„åˆ™ï¼š</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=n>URL</span> <span class=err>è¾“å…¥</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;url&#34;</span><span class=p>)</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>ä½¿ç”¨â€œ</span><span class=n>file</span><span class=o>-</span><span class=n>downloader</span><span class=err>â€å·¥å…·ä¸‹è½½è®ºæ–‡</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>æå–å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ä½œè€…ã€å¹´ä»½ï¼‰</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>è¿”å›ä¿å­˜çš„æ–‡ä»¶è·¯å¾„å’Œå…ƒæ•°æ®</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>æ–‡ä»¶è¾“å…¥</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;file&#34;</span><span class=p>)</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>ä½¿ç”¨</span> <span class=n>move_file_to</span> <span class=err>å·¥å…·å°†æ–‡ä»¶ç§»åŠ¨åˆ°â€œ</span><span class=o>./</span><span class=n>deepcode_lab</span><span class=o>/</span><span class=n>papers</span><span class=o>/</span><span class=n>id</span><span class=o>/</span><span class=err>â€</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>move_file_to</span> <span class=err>å·¥å…·ä¼šè‡ªåŠ¨å°†</span> <span class=n>PDF</span><span class=o>/</span><span class=err>æ–‡æ¡£è½¬æ¢ä¸º</span> <span class=o>.</span><span class=n>md</span> <span class=err>æ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>åˆ‡å‹¿æ‰‹åŠ¨æå–å†…å®¹æˆ–ä½¿ç”¨</span> <span class=n>write_file</span> <span class=o>-</span> <span class=err>è®©è½¬æ¢å·¥å…·å¤„ç†</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>è¿”å›æ–°ä¿å­˜çš„æ–‡ä»¶è·¯å¾„å’Œå…ƒæ•°æ®</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=err>ç›®å½•è¾“å…¥</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;directory&#34;</span><span class=p>)</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>éªŒè¯ç›®å½•æ˜¯å¦å­˜åœ¨</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>è¿”å›</span> <span class=n>PaperInputAnalyzerAgent</span> <span class=err>è¿›è¡Œå¤„ç†</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>å°†çŠ¶æ€è®¾ç½®ä¸ºâ€œå¤±è´¥â€å¹¶æ˜¾ç¤ºæ¶ˆæ¯</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=err>æ–‡æœ¬è¾“å…¥</span> <span class=p>(</span><span class=n>input_type</span> <span class=o>=</span> <span class=s2>&#34;text&#34;</span><span class=p>)</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>æ— éœ€è¿›è¡Œæ–‡ä»¶æ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>å°†</span> <span class=n>paper_path</span> <span class=err>è®¾ç½®ä¸º</span> <span class=n>null</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>ä½¿ç”¨è¾“å…¥ä¸­çš„</span> <span class=n>paper_info</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>è¾“å…¥æ ¼å¼ï¼š</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;file|directory|url|text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;detected path or null&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;paper title or N/A&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;author names or N/A&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;publication year or N/A&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;requirement1&#34;</span><span class=p>,</span> <span class=s2>&#34;requirement2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>è¾“å‡ºæ ¼å¼ï¼ˆè¯·å‹¿ä¿®æ”¹ï¼‰ï¼š</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;success|failure&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_path&#34;</span><span class=p>:</span> <span class=s2>&#34;path to paper file or null for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;extracted or provided title&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;extracted or provided authors&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;extracted or provided year&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®<code>input_type</code>çš„ä¸åŒè¿›è¡Œä¸åŒçš„æ“ä½œï¼Œç»ˆäºæŠŠ<code>paper_info</code>æå–å‡ºæ¥äº†ï¼Œå®³å¾—æˆ‘è¯»äº†å¥½ä¹…ï¼ˆ</p><p>æˆ‘ä»¬è¦å…³æ³¨çš„å·¥å…·å…¶å®å°±ä¸¤ä¸ªï¼š<code>file-downloader</code>ï¼Œ<code>move_file_to</code>ï¼Œæ ¹æ®promptï¼Œå‰è€…ç”¨æ¥ä¸‹è½½è®ºæ–‡ï¼Œåè€…ç”¨æ¥å°†pdfè½¬æ¢æˆ.mdæ ¼å¼</p><p>çœ‹ä¸€ä¸‹ä½¿ç”¨çš„å·¥å…·ï¼š<code>server_names=["filesystem", "file-downloader"]</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># On windows update the command and arguments to use `node` and the absolute path to the server.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Use `npm i -g @modelcontextprotocol/server-filesystem` to install the server globally.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Use `npm -g root` to find the global node_modules path.`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># command: &#34;node&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># args: [&#34;c:/Program Files/nodejs/node_modules/@modelcontextprotocol/server-filesystem/dist/index.js&#34;,&#34;.&#34;]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;npx&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;-y&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class=w> </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>file-downloader</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;python&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&#34;tools/pdf_downloader.py&#34;</span><span class=w> </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PYTHONPATH</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;.&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><code>filesystem</code>å°±æ˜¯æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæ²¡å•¥ç‰¹æ®Šçš„ï¼Œæ²¡æœ‰æˆ‘ä»¬æƒ³çœ‹çš„ä¸¤ä¸ªå·¥å…·ï¼Œè®©æˆ‘ä»¬çœ‹<code>file-downloader</code>ï¼Œæ¥åˆ°<code>tools/pdf_downloader.py</code></p><p>ç›´æ¥æ¥<code>if __name__ == "__main__":</code>çœ‹ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬è¦çœ‹çš„ä¸¤ä¸ªå‡½æ•°éƒ½åœ¨è¿™é‡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Available tools:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;  â€¢ download_files - Download files or move local files from natural language&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  â€¢ parse_download_urls - Extract URLs, local paths and destination paths&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  â€¢ download_file_to - Download a specific file with options&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  â€¢ move_file_to - Move a specific local file with options&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  â€¢ convert_document_to_markdown - Convert documents to Markdown format&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä»–çš„å·¥å…·éƒ½æ˜¯ä¸‹è½½ç”¨çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<code>move_file_to</code>ï¼Œåˆšåˆšprompté‡Œæåˆ°äº†å®ƒä¼šæŠŠpdfè½¬æˆmarkdownï¼Œæˆ‘ä»¬æ¥çœ‹ä»–æ˜¯æ€ä¹ˆå¤„ç†çš„</p><p>è¦æ‰¾åˆ°è¿™ä¸ªå·¥å…·ç›´æ¥åœ¨æ–‡ä»¶é‡Œæœç´¢<code>@mcp.tool()</code>å³å¯ï¼Œå¾ˆå¿«èƒ½å®šä½åˆ°è¯¥å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·çš„æ³¨é‡Šæ€ä¹ˆå…¨æ˜¯ä¸­æ–‡ï¼Œçœ‹æ¥åˆæ˜¯ä¸­å›½å¼€å‘è€…å†™çš„ï¼ˆ</p><p>å‰é¢çš„ä»£ç éƒ½æ˜¯åœ¨å¤„ç†è·¯å¾„ï¼Œå’Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ ¸å¿ƒä»£ç åœ¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ‰§è¡Œç§»åŠ¨</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>move_local_file</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>target_path</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬è¿›æ¥çœ‹<code>move_local_file</code>ï¼Œè¿™ä¸ªå‡½æ•°çš„æ ¸å¿ƒä»£ç åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ‰§è¡Œç§»åŠ¨æ“ä½œ</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>move</span><span class=p>(</span><span class=n>source_path</span><span class=p>,</span> <span class=n>destination</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¥½å§å°±æ˜¯æ–‡ä»¶å¤åˆ¶ï¼Œåœ¨<code>move_local_file</code>é‡Œç»§ç»­å¾€ä¸‹çœ‹ï¼Œå‘ç°äº†ç§»åŠ¨æˆåŠŸæœ‰ä¸€ä¸ªè½¬æ¢çš„ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>conversion_msg</span> <span class=o>=</span> <span class=k>await</span> <span class=n>perform_document_conversion</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>target_path</span><span class=p>,</span> <span class=n>extract_images</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é‚£æˆ‘ä»¬æ¥çœ‹<code>perform_document_conversion</code>ï¼Œå¾ˆå®¹æ˜“å‘ç°å®ƒå…¶å®å°±æ˜¯ç”¨<code>PyPDF2</code>åŒ…å»åšäº†ä¸ªè½¬æ¢ï¼Œæ ¸å¿ƒä»£ç åœ¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>simple_converter</span> <span class=o>=</span> <span class=n>SimplePdfConverter</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>conversion_result</span> <span class=o>=</span> <span class=n>simple_converter</span><span class=o>.</span><span class=n>convert_pdf_to_markdown</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹<code>SimplePdfConverter</code>ç±»æœ‰æ²¡æœ‰<code>init</code>å‡½æ•°ï¼Œå¥½æ²¡æœ‰ï¼Œé‚£æˆ‘ä»¬è¿›æ¥çœ‹<code>convert_pdf_to_markdown</code></p><p>å•Šè¿™å®ƒè¿™ä¸ªé€»è¾‘æ²¡æˆ‘æƒ³çš„é«˜å¤§ä¸Šï¼Œå°±æ˜¯æ‹¿<code>PyPDF2</code>å¤„ç†é‡Œä¸€ä¸‹ï¼Œæˆ‘æŠŠè¿™ä¸ªå•ç‹¬æå‡ºæ¥å½“ä¸€ä¸ªè„šæœ¬è·‘äº†ä¸€ä¸‹ï¼Œä¸‹é¢æ˜¯æˆ‘æå–å‡ºçš„è„šæœ¬çš„å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>PyPDF2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_pdf_to_markdown</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>input_file</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>output_file</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    ä½¿ç”¨PyPDF2å°†PDFè½¬æ¢ä¸ºMarkdownæ ¼å¼
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        input_file: è¾“å…¥PDFæ–‡ä»¶è·¯å¾„
</span></span></span><span class=line><span class=cl><span class=s2>        output_file: è¾“å‡ºMarkdownæ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        è½¬æ¢ç»“æœå­—å…¸
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># æ£€æŸ¥è¾“å…¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>input_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Input file not found: </span><span class=si>{</span><span class=n>input_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># å¦‚æœæ²¡æœ‰æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆ</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>output_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>base_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>input_file</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>output_file</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>base_name</span><span class=si>}</span><span class=s2>.md&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨</span>
</span></span><span class=line><span class=cl>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>output_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_dir</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>output_dir</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># æ‰§è¡Œè½¬æ¢</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è¯»å–PDFæ–‡ä»¶</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pdf_reader</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>text_content</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># æå–æ¯é¡µæ–‡æœ¬</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>page_num</span><span class=p>,</span> <span class=n>page</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>pdf_reader</span><span class=o>.</span><span class=n>pages</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>text</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>extract_text</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>text</span><span class=o>.</span><span class=n>strip</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=n>text_content</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;## Page </span><span class=si>{</span><span class=n>page_num</span><span class=si>}</span><span class=se>\n\n</span><span class=si>{</span><span class=n>text</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ç”ŸæˆMarkdownå†…å®¹</span>
</span></span><span class=line><span class=cl>        <span class=n>markdown_content</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;# Extracted from </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>input_file</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>markdown_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;*Total pages: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>pdf_reader</span><span class=o>.</span><span class=n>pages</span><span class=p>)</span><span class=si>}</span><span class=s2>*</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>markdown_content</span> <span class=o>+=</span> <span class=s2>&#34;---</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>markdown_content</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>text_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ä¿å­˜åˆ°æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>markdown_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è®¡ç®—è½¬æ¢æ—¶é—´</span>
</span></span><span class=line><span class=cl>        <span class=n>duration</span> <span class=o>=</span> <span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è·å–æ–‡ä»¶å¤§å°</span>
</span></span><span class=line><span class=cl>        <span class=n>input_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>input_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>output_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>output_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;input_file&#34;</span><span class=p>:</span> <span class=n>input_file</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;output_file&#34;</span><span class=p>:</span> <span class=n>output_file</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;input_size&#34;</span><span class=p>:</span> <span class=n>input_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;output_size&#34;</span><span class=p>:</span> <span class=n>output_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;duration&#34;</span><span class=p>:</span> <span class=n>duration</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;markdown_content&#34;</span><span class=p>:</span> <span class=n>markdown_content</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;pages_extracted&#34;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>pdf_reader</span><span class=o>.</span><span class=n>pages</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;success&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;input_file&#34;</span><span class=p>:</span> <span class=n>input_file</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Conversion failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>convert_pdf_to_markdown</span><span class=p>(</span><span class=s2>&#34;test.pdf&#34;</span><span class=p>,</span> <span class=s2>&#34;test.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è·‘äº†ä¸€ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{&#39;success&#39;: True, &#39;input_file&#39;: &#39;test.pdf&#39;, &#39;output_file&#39;: &#39;test.md&#39;, &#39;input_size&#39;: 1852204, &#39;output_size&#39;: 59825, &#39;duration&#39;: 0.124518, &#39;pages_extracted&#39;: 15}
</span></span></code></pre></td></tr></table></div></div><p>é€Ÿåº¦è¿˜æŒºå¿«ï¼Œä¹Ÿä¸çŸ¥é“å¯¹å›¾ç‰‡åšæ²¡åšå¤„ç†ï¼Œå…¶å®å°±æ˜¯ç”¨<code>PyPDF2</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ·±å…¥çœ‹äº†ï¼Œé‚£æˆ‘ä»¬å°±æŠŠ<code>run_resource_processor</code>çœ‹å®Œäº†ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„å°±æ˜¯llmå“åº”çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>    &#34;status&#34;: &#34;success|failure&#34;,
</span></span><span class=line><span class=cl>    &#34;paper_path&#34;: &#34;path to paper file or null for text input&#34;,
</span></span><span class=line><span class=cl>    &#34;metadata&#34;: {
</span></span><span class=line><span class=cl>        &#34;title&#34;: &#34;extracted or provided title&#34;,
</span></span><span class=line><span class=cl>        &#34;authors&#34;: [&#34;extracted or provided authors&#34;],
</span></span><span class=line><span class=cl>        &#34;year&#34;: &#34;extracted or provided year&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå‘ç°<code>orchestrate_research_analysis_agent</code>ä¹Ÿè¯»å®Œäº†ï¼ŒçœŸå¥½</p><p>Phase 2åˆ°è¿™é‡Œä¹Ÿç»“æŸå•¦ï¼Œæˆ‘ä»¬æ‰“ä¸ªæ–­ç‚¹æ¥çœ‹ä¸‹è¿è¡Œåˆ°è¿™é‡Œçš„ç»“æœ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;analysis_result:&#34;</span> <span class=o>+</span> <span class=n>analysis_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;download_result:&#34;</span> <span class=o>+</span> <span class=n>download_result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥çœ‹çœ‹<code>analysis_result</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;input_type&#34;</span><span class=p>:</span> <span class=s2>&#34;file&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;path&#34;</span><span class=p>:</span> <span class=s2>&#34;test.pdf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;paper_info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;N/A for text input&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;N/A for text input&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;requirements&#34;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥çœ‹çœ‹<code>download_result</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>I</span><span class=s1>&#39;ll process this file input by first checking the papers directory to generate the </span>
</span></span><span class=line><span class=cl><span class=n>correct</span> <span class=n>ID</span><span class=p>,</span> <span class=n>then</span> <span class=n>moving</span> <span class=n>the</span> <span class=n>file</span> <span class=n>to</span> <span class=n>the</span> <span class=n>appropriate</span> <span class=n>location</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_list_directory</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=n>I</span> <span class=n>need</span> <span class=n>to</span> <span class=n>create</span> <span class=n>the</span> <span class=n>papers</span> <span class=n>directory</span> <span class=n>first</span><span class=p>,</span> <span class=n>then</span> <span class=n>generate</span> <span class=n>the</span> <span class=n>ID</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_create_directory</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_list_directory</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>papers</span> <span class=n>directory</span> <span class=n>is</span> <span class=n>empty</span><span class=p>,</span> <span class=n>so</span> <span class=n>the</span> <span class=n>ID</span> <span class=n>will</span> <span class=n>be</span> <span class=mf>1.</span> <span class=n>Now</span> <span class=n>I</span><span class=s1>&#39;ll create the directory for this paper and move </span>
</span></span><span class=line><span class=cl><span class=n>the</span> <span class=n>file</span> <span class=n>using</span> <span class=n>the</span> <span class=n>file</span><span class=o>-</span><span class=n>downloader</span> <span class=k>tool</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_create_directory</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers/1&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>file</span><span class=o>-</span><span class=n>downloader_move_file_to</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;source&#39;</span><span class=p>:</span> <span class=s1>&#39;test.pdf&#39;</span><span class=p>,</span> <span class=s1>&#39;destination&#39;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl><span class=s1>&#39;./deepcode_lab/papers/1/1.md&#39;</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=n>Perfect</span><span class=o>!</span> <span class=n>The</span> <span class=n>file</span> <span class=n>has</span> <span class=n>been</span> <span class=n>moved</span> <span class=ow>and</span> <span class=n>converted</span> <span class=n>to</span> <span class=n>Markdown</span><span class=o>.</span> <span class=n>Now</span> <span class=n>let</span> <span class=n>me</span> <span class=n>read</span> <span class=n>the</span> <span class=n>converted</span> <span class=n>file</span> <span class=n>to</span> <span class=n>extract</span> 
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_read_text_file</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers/1/1.md&#39;</span><span class=p>,</span> <span class=s1>&#39;head&#39;</span><span class=p>:</span> <span class=mi>50</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=n>Excellent</span><span class=o>!</span> <span class=n>I</span> <span class=n>can</span> <span class=n>extract</span> <span class=n>the</span> <span class=n>metadata</span> <span class=n>from</span> <span class=n>the</span> <span class=n>converted</span> <span class=n>paper</span><span class=o>.</span> <span class=n>Let</span> <span class=n>me</span> <span class=n>get</span> <span class=n>a</span> <span class=n>bit</span> <span class=n>more</span> <span class=n>content</span> <span class=n>to</span> <span class=n>ensure</span> <span class=n>I</span> 
</span></span><span class=line><span class=cl><span class=n>have</span> <span class=n>complete</span> <span class=n>information</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>Calling</span> <span class=k>tool</span> <span class=n>filesystem_read_text_file</span> <span class=n>with</span> <span class=n>args</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;./deepcode_lab/papers/1/1.md&#39;</span><span class=p>,</span> <span class=s1>&#39;head&#39;</span><span class=p>:</span> <span class=mi>20</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=n>Perfect</span><span class=o>!</span> <span class=n>I</span> <span class=n>have</span> <span class=n>successfully</span> <span class=n>processed</span> <span class=n>the</span> <span class=n>file</span> <span class=n>input</span> <span class=ow>and</span> <span class=n>extracted</span> <span class=n>the</span> <span class=n>metadata</span><span class=o>.</span> <span class=n>Here</span><span class=s1>&#39;s the output:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;success&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_path&#34;</span><span class=p>:</span> <span class=s2>&#34;./deepcode_lab/papers/1/1.md&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Enhancing EEG-to-Text Decoding through Transferable Representations from Pre-trained </span>
</span></span><span class=line><span class=cl><span class=n>Contrastive</span> <span class=n>EEG</span><span class=o>-</span><span class=n>Text</span> <span class=n>Masked</span> <span class=n>Autoencoder</span><span class=s2>&#34;,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Jiaqi Wang&#34;</span><span class=p>,</span> <span class=s2>&#34;Zhenxi Song&#34;</span><span class=p>,</span> <span class=s2>&#34;Zhengyu Ma&#34;</span><span class=p>,</span> <span class=s2>&#34;Xipeng Qiu&#34;</span><span class=p>,</span> <span class=s2>&#34;Min Zhang&#34;</span><span class=p>,</span> <span class=s2>&#34;Zhiguo Zhang&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;year&#34;</span><span class=p>:</span> <span class=s2>&#34;2024&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>file</span> <span class=n>has</span> <span class=n>been</span> <span class=n>successfully</span> <span class=n>moved</span> <span class=n>from</span> <span class=err>`</span><span class=n>test</span><span class=o>.</span><span class=n>pdf</span><span class=err>`</span> <span class=n>to</span> <span class=err>`</span><span class=o>./</span><span class=n>deepcode_lab</span><span class=o>/</span><span class=n>papers</span><span class=o>/</span><span class=mi>1</span><span class=o>/</span><span class=mf>1.</span><span class=n>md</span><span class=err>`</span> <span class=ow>and</span> <span class=n>automatically</span> 
</span></span><span class=line><span class=cl><span class=n>converted</span> <span class=n>from</span> <span class=n>PDF</span> <span class=n>to</span> <span class=n>Markdown</span> <span class=n>format</span><span class=o>.</span> <span class=n>The</span> <span class=n>conversion</span> <span class=n>extracted</span> <span class=mi>15</span> <span class=n>pages</span> <span class=ow>and</span> <span class=n>I</span> <span class=n>was</span> <span class=n>able</span> <span class=n>to</span> <span class=n>extract</span> <span class=n>the</span> 
</span></span><span class=line><span class=cl><span class=n>complete</span> <span class=n>metadata</span> <span class=n>including</span> <span class=n>the</span> <span class=n>title</span><span class=p>,</span> <span class=n>authors</span><span class=p>,</span> <span class=ow>and</span> <span class=n>publication</span> <span class=n>year</span> <span class=n>from</span> <span class=n>the</span> <span class=n>ACL</span> <span class=mi>2024</span> <span class=n>conference</span> 
</span></span><span class=line><span class=cl><span class=n>proceedings</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘æŠŠå·¥å…·è°ƒç”¨ç”»æˆäº†æµç¨‹å›¾</p><pre class=mermaid>
  graph TD
    A[filesystem_list_directory&lt;br&gt;path: &#39;./deepcode_lab/papers&#39;]
    A --&gt; B[filesystem_create_directory&lt;br&gt;path: &#39;./deepcode_lab/papers&#39;]
    B --&gt; C[filesystem_list_directory&lt;br&gt;path: &#39;./deepcode_lab/papers&#39;]
    C --&gt; D[filesystem_create_directory&lt;br&gt;path: &#39;./deepcode_lab/papers/1&#39;]
    D --&gt; E[file-downloader_move_file_to&lt;br&gt;source: &#39;test.pdf&#39;&lt;br&gt;dest: &#39;.../papers/1/1.md&#39;]
    E --&gt; F[filesystem_read_text_file&lt;br&gt;path: &#39;.../papers/1/1.md&#39;&lt;br&gt;head: 50]
    F --&gt; G[filesystem_read_text_file&lt;br&gt;path: &#39;.../papers/1/1.md&#39;&lt;br&gt;head: 20]
</pre><p>é‚£ä¹ˆå¾ˆæ¸…æ™°äº†ï¼ŒåŸæ¥meta-dataçš„æå–æœ‰read_text_fileçš„è¿‡ç¨‹ï¼Œé‚£æ²¡ä»€ä¹ˆé—®é¢˜äº†ï¼Œphase2åœ†æ»¡ç»“æŸ</p><h3 id=phase3>phase3</h3><p>è¿™ä¸ªé˜¶æ®µå«Phase 3: Workspace Infrastructure Synthesisï¼Œä½†æ˜¯æˆ‘æ²¡ææ‡‚æ€ä¹ˆç¿»è¯‘ï¼Œå¤§å®¶å§‘ä¸”è®¤ä¸ºæ˜¯è§„åˆ’æ–‡ä»¶è·¯å¾„</p><p>æ ¸å¿ƒä»£ç åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>dir_info</span> <span class=o>=</span> <span class=k>await</span> <span class=n>synthesize_workspace_infrastructure_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>download_result</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=n>workspace_dir</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹<code>synthesize_workspace_infrastructure_agent</code></p><p>é¦–å…ˆæ¥çœ‹è¿™ä¸€æ®µï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Parse download result to get file information</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>FileProcessor</span><span class=o>.</span><span class=n>process_file_input</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>download_result</span><span class=p>,</span> <span class=n>base_dir</span><span class=o>=</span><span class=n>workspace_dir</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿›æ¥çœ‹çœ‹<code>FileProcessor.process_file_input</code></p><p>è¿™ä¸ªå‡½æ•°å¤ªå¤æ‚äº†ï¼Œä½†æˆ‘æå–å‡ºæ¥è·‘äº†ä¸€ä¸‹å‘ç°æ˜¯è·å–è®ºæ–‡çš„åœ°å€ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œè·‘å‡ºæ¥å°±æ˜¯ï¼š<code>/Users/dinglizhi/Desktop/coderead/DeepCode/deepcode_lab/papers/1</code></p><p>è¿™ä¸ªå†™æ³•å®Œå…¨æ²¡å¿…è¦å•Šï¼Œç›´æ¥æå–<code>download_result</code>å°±å¥½äº†ï¼Œæˆ‘ä»¬æœ‰<code>extract_clean_json</code>è¿˜è®°å¾—å—ï¼Œèƒ½å–å‡ºæ¥<code>"paper_path": "./deepcode_lab/papers/1/1.md",</code>ï¼Œå°±è§£å†³äº†ï¼Œæ‰€ä»¥è¿™ç§é«˜starçš„å¼€æºé¡¹ç›®å†™æ³•ä¹Ÿå¹¶éå®Œç¾ï¼Œå¤§å®¶è¯»çš„æ—¶å€™ä¸€å®šè¦æœ‰è‡ªå·±çš„æ€è€ƒ</p><p>ç„¶åè¿™ä¸ªå‡½æ•°è¿”å›çš„å…¶å®æ˜¯æœ€ä½³æ„æˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;paper_dir&#34;</span><span class=p>:</span> <span class=n>paper_dir</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;standardized_text&#34;</span><span class=p>:</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;standardized_text&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;reference_path&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>paper_dir</span><span class=p>,</span> <span class=s2>&#34;reference.txt&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;initial_plan_path&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>paper_dir</span><span class=p>,</span> <span class=s2>&#34;initial_plan.txt&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;download_path&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>paper_dir</span><span class=p>,</span> <span class=s2>&#34;github_download.txt&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;index_report_path&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>paper_dir</span><span class=p>,</span> <span class=s2>&#34;codebase_index_report.txt&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;implementation_report_path&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>paper_dir</span><span class=p>,</span> <span class=s2>&#34;code_implementation_report.txt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;workspace_dir&#34;</span><span class=p>:</span> <span class=n>workspace_dir</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=phase35>phase3.5</h3><p>è¯¥é˜¶æ®µæ˜¯åšæ–‡æ¡£çš„åˆ†å‰²å’Œé¢„å¤„ç†</p><p>ä¸‹é¢æ˜¯æ ¸å¿ƒä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>segmentation_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>orchestrate_document_preprocessing_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>dir_info</span><span class=p>,</span> <span class=n>logger</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥è®©æˆ‘ä»¬è¿›æ¥çœ‹<code>orchestrate_document_preprocessing_agent</code></p><p>å…ˆçœ‹æ³¨é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Orchestrate adaptive document preprocessing with intelligent segmentation control.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This agent autonomously determines whether to use document segmentation based on
</span></span><span class=line><span class=cl>configuration settings and document size, then applies the appropriate processing strategy.
</span></span></code></pre></td></tr></table></div></div><p>ä¸­æ–‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>é€šè¿‡æ™ºèƒ½åˆ†å‰²æ§åˆ¶æ¥åè°ƒè‡ªé€‚åº”æ–‡æ¡£é¢„å¤„ç†ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¯¥ä»£ç†ä¼šæ ¹æ®é…ç½®è®¾ç½®å’Œæ–‡æ¡£å¤§å°è‡ªä¸»ç¡®å®šæ˜¯å¦ä½¿ç”¨æ–‡æ¡£åˆ†å‰²ï¼Œç„¶ååº”ç”¨é€‚å½“çš„å¤„ç†ç­–ç•¥ã€‚
</span></span></code></pre></td></tr></table></div></div><h4 id=step1>step1</h4><p>ç¬¬ä¸€æ­¥ä¸»è¦æ˜¯æå–æ‰€æœ‰æ–‡ä»¶ï¼Œä»£ç å¾ˆç®€å•ï¼Œå°±ä¸è¿‡å¤šè§£é‡Šäº†ï¼Œæ ¸å¿ƒåœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>md_files</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>dir_info</span><span class=p>[</span><span class=s2>&#34;paper_dir&#34;</span><span class=p>])</span> <span class=k>if</span> <span class=n>f</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&#34;.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=step2>step2</h4><p>è¯»å–æ–‡ä»¶çš„å†…å®¹æ¥ç¡®å®šæ–‡ä»¶çš„å¤§å°ï¼Œè¿™é‡Œåªè¯»å–äº†ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶ååˆ¤æ–­äº†å¦‚æœè¿˜æ˜¯pdfå°±æ‰“æ–­è®©ä»–å›å»åšæ ¼å¼è½¬æ¢</p><p><code>document_content</code>æ˜¯æ–‡ä»¶çš„å†…å®¹</p><h4 id=step3>step3</h4><p>ç¡®å®šæ˜¯å¦åˆ†å—</p><p>æ ¸å¿ƒä»£ç åœ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Step 3: Determine if segmentation should be used</span>
</span></span><span class=line><span class=cl><span class=n>should_segment</span><span class=p>,</span> <span class=n>reason</span> <span class=o>=</span> <span class=n>should_use_document_segmentation</span><span class=p>(</span><span class=n>document_content</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥è®©æˆ‘ä»¬è¿›æ¥çœ‹<code>should_use_document_segmentation</code></p><p>è¿™é‡Œä¸»è¦æ˜¯ä¾é <code>mcp_agent.config.yaml</code>ä¸­çš„å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>document_segmentation</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>size_threshold_chars</span><span class=p>:</span><span class=w> </span><span class=m>50000</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å½“enabledçš„æ—¶å€™ï¼Œå¹¶ä¸”æ–‡æ¡£çš„é•¿åº¦ > <code>size_threshold_chars</code>çš„æ—¶å€™å°±åˆ†å‰²</p><p>ç„¶åæ˜¯æ­£å¼çš„åˆ†å‰²çš„ä»£ç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Prepare document segments using the segmentation agent</span>
</span></span><span class=line><span class=cl><span class=n>segmentation_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>prepare_document_segments</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>paper_dir</span><span class=o>=</span><span class=n>dir_info</span><span class=p>[</span><span class=s2>&#34;paper_dir&#34;</span><span class=p>],</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬è¿›æ¥çœ‹<code>prepare_document_segments</code>ï¼Œè€æ ·å­å…ˆçœ‹æ³¨é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Prepare intelligent document segments optimized for planning agents.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This enhanced function leverages semantic analysis to create segments that:
</span></span><span class=line><span class=cl>- Preserve algorithm and formula integrity
</span></span><span class=line><span class=cl>- Optimize for ConceptAnalysisAgent, AlgorithmAnalysisAgent, and CodePlannerAgent
</span></span><span class=line><span class=cl>- Use adaptive character limits based on content complexity
</span></span><span class=line><span class=cl>- Maintain technical content completeness
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Called from the orchestration engine (Phase 3.5) to prepare documents
</span></span><span class=line><span class=cl>before the planning phase with superior segmentation quality.
</span></span></code></pre></td></tr></table></div></div><p>ä¸­æ–‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ä¸ºè§„åˆ’ä»£ç†å‡†å¤‡ä¼˜åŒ–çš„æ™ºèƒ½æ–‡æ¡£åˆ†æ®µã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>æ­¤å¢å¼ºåŠŸèƒ½åˆ©ç”¨è¯­ä¹‰åˆ†ææ¥åˆ›å»ºåˆ†æ®µï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š
</span></span><span class=line><span class=cl>- ä¿ç•™ç®—æ³•å’Œå…¬å¼çš„å®Œæ•´æ€§
</span></span><span class=line><span class=cl>- é’ˆå¯¹ ConceptAnalysisAgentã€AlgorithmAnalysisAgent å’Œ CodePlannerAgent è¿›è¡Œä¼˜åŒ–
</span></span><span class=line><span class=cl>- æ ¹æ®å†…å®¹å¤æ‚åº¦ä½¿ç”¨è‡ªé€‚åº”å­—ç¬¦é™åˆ¶
</span></span><span class=line><span class=cl>- ä¿æŒæŠ€æœ¯å†…å®¹çš„å®Œæ•´æ€§
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ä»ç¼–æ’å¼•æ“ï¼ˆç¬¬ 3.5 é˜¶æ®µï¼‰è°ƒç”¨ï¼Œç”¨äºåœ¨è§„åˆ’é˜¶æ®µä¹‹å‰å‡†å¤‡æ–‡æ¡£ï¼Œå¹¶å®ç°å“è¶Šçš„åˆ†æ®µè´¨é‡ã€‚
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œçš„æ ¸å¿ƒä»£ç æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Run analysis</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>run_document_segmentation_analysis</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>paper_dir</span><span class=o>=</span><span class=n>paper_dir</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>force_refresh</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>  <span class=c1># Use cached analysis if available</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹<code>run_document_segmentation_analysis</code></p><p>è¿™é‡Œçš„æ ¸å¿ƒä»£ç æ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Analyze and prepare document</span>
</span></span><span class=line><span class=cl><span class=n>analysis_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>agent</span><span class=o>.</span><span class=n>analyze_and_prepare_document</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>paper_dir</span><span class=p>,</span> <span class=n>force_refresh</span><span class=o>=</span><span class=n>force_refresh</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬æ¥çœ‹<code>analyze_and_prepare_document</code></p><p>é¦–å…ˆè¿˜æ˜¯å–å‡ºæ‰€æœ‰markdown</p><p>ç„¶åæ˜¯åŠ¨æ€ç”Ÿæˆäº†ä¸€æ®µæç¤ºè¯ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œè¿™ä¸ªåº”è¯¥å°±æ˜¯åˆ†å—çš„æ ¸å¿ƒæ‰€åœ¨äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>Please perform intelligent semantic analysis and segmentation for the document in directory: {paper_dir}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use the analyze_and_segment_document tool with these parameters:
</span></span><span class=line><span class=cl><span class=k>-</span> paper_dir: {paper_dir}
</span></span><span class=line><span class=cl><span class=k>-</span> force_refresh: {force_refresh}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gs>**Focus on these enhanced objectives**</span>:
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**Semantic Document Classification**</span>: Identify document type using content semantics (research_paper, algorithm_focused, technical_doc, etc.)
</span></span><span class=line><span class=cl><span class=k>2.</span> <span class=gs>**Intelligent Segmentation Strategy**</span>: Select the optimal strategy based on content analysis:
</span></span><span class=line><span class=cl>   <span class=k>-</span> <span class=sb>`semantic_research_focused`</span> for research papers with high algorithm density
</span></span><span class=line><span class=cl>   <span class=k>-</span> <span class=sb>`algorithm_preserve_integrity`</span> for algorithm-heavy documents
</span></span><span class=line><span class=cl>   <span class=k>-</span> <span class=sb>`concept_implementation_hybrid`</span> for mixed concept/implementation content
</span></span><span class=line><span class=cl><span class=k>3.</span> <span class=gs>**Algorithm Completeness**</span>: Ensure algorithm blocks, formulas, and related descriptions remain logically connected
</span></span><span class=line><span class=cl><span class=k>4.</span> <span class=gs>**Planning Agent Optimization**</span>: Create segments that maximize effectiveness for ConceptAnalysisAgent, AlgorithmAnalysisAgent, and CodePlannerAgent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>After segmentation, get a document overview and provide:
</span></span><span class=line><span class=cl><span class=k>-</span> Quality assessment of semantic segmentation approach
</span></span><span class=line><span class=cl><span class=k>-</span> Algorithm/formula integrity verification
</span></span><span class=line><span class=cl><span class=k>-</span> Recommendations for planning agent optimization
</span></span><span class=line><span class=cl><span class=k>-</span> Technical content completeness evaluation
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>è¯·å¯¹ç›®å½• {paper_dir} ä¸­çš„æ–‡æ¡£è¿›è¡Œæ™ºèƒ½è¯­ä¹‰åˆ†æå’Œåˆ†æ®µã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ä½¿ç”¨ analyze_and_segment_document å·¥å…·å¹¶è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼š
</span></span><span class=line><span class=cl><span class=k>-</span> paper_dir: {paper_dir}
</span></span><span class=line><span class=cl><span class=k>-</span> force_refresh: {force_refresh}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gs>**é‡ç‚¹å…³æ³¨ä»¥ä¸‹å¢å¼ºç›®æ ‡**</span>ï¼š
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**è¯­ä¹‰æ–‡æ¡£åˆ†ç±»**</span>ï¼šä½¿ç”¨å†…å®¹è¯­ä¹‰è¯†åˆ«æ–‡æ¡£ç±»å‹ï¼ˆç ”ç©¶è®ºæ–‡ã€ç®—æ³•é‡ç‚¹ã€æŠ€æœ¯æ–‡æ¡£ç­‰ï¼‰ã€‚
</span></span><span class=line><span class=cl><span class=k>2.</span> <span class=gs>**æ™ºèƒ½åˆ†æ®µç­–ç•¥**</span>ï¼šæ ¹æ®å†…å®¹åˆ†æé€‰æ‹©æœ€ä½³ç­–ç•¥ï¼š
</span></span><span class=line><span class=cl><span class=k>-</span> <span class=sb>`semantic_research_focused`</span> ç”¨äºç®—æ³•å¯†é›†å‹ç ”ç©¶è®ºæ–‡
</span></span><span class=line><span class=cl><span class=k>-</span> <span class=sb>`algorithm_preserve_integrity`</span> ç”¨äºç®—æ³•å¯†é›†å‹æ–‡æ¡£
</span></span><span class=line><span class=cl><span class=k>-</span> <span class=sb>`concept_implementation_hybrid`</span> ç”¨äºæ¦‚å¿µ/å®ç°æ··åˆå†…å®¹
</span></span><span class=line><span class=cl><span class=k>3.</span> <span class=gs>**ç®—æ³•å®Œæ•´æ€§**</span>ï¼šç¡®ä¿ç®—æ³•å—ã€å…¬å¼å’Œç›¸å…³æè¿°ä¿æŒé€»è¾‘å…³è”
</span></span><span class=line><span class=cl><span class=k>4.</span> <span class=gs>**è§„åˆ’ä»£ç†ä¼˜åŒ–**</span>ï¼šåˆ›å»ºå¯æœ€å¤§é™åº¦æé«˜æ•ˆç‡çš„åˆ†æ®µä¸ºäº†ConceptAnalysisAgentã€AlgorithmAnalysisAgent å’Œ CodePlannerAgent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>åˆ†å‰²åï¼Œè·å–æ–‡æ¡£æ¦‚è§ˆå¹¶æä¾›ï¼š
</span></span><span class=line><span class=cl><span class=k>-</span> è¯­ä¹‰åˆ†å‰²æ–¹æ³•çš„è´¨é‡è¯„ä¼°
</span></span><span class=line><span class=cl><span class=k>-</span> ç®—æ³•/å…¬å¼çš„å®Œæ•´æ€§éªŒè¯
</span></span><span class=line><span class=cl><span class=k>-</span> è§„åˆ’ä»£ç†ä¼˜åŒ–å»ºè®®
</span></span><span class=line><span class=cl><span class=k>-</span> æŠ€æœ¯å†…å®¹å®Œæ•´æ€§è¯„ä¼°
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œå‘ç°ä»–ç›´æ¥ç”¨äº†llmï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>__init__</code>å’Œ<code>initialize</code>ï¼Œå‘ç°agentæ˜¯åœ¨<code>initialize</code>é‡Œåˆå§‹åŒ–çš„</p><p>è¿™ä¸ªagentä¹Ÿæœ‰ä¸€ä¸ªpromptï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>You are an intelligent document segmentation coordinator that leverages advanced semantic analysis for optimal document processing.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Your enhanced capabilities include:
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**Semantic Content Analysis**</span>: Coordinate intelligent document type classification based on content semantics rather than structural patterns
</span></span><span class=line><span class=cl><span class=k>2.</span> <span class=gs>**Algorithm Integrity Protection**</span>: Ensure algorithm blocks, formulas, and related content maintain logical coherence
</span></span><span class=line><span class=cl><span class=k>3.</span> <span class=gs>**Adaptive Segmentation Strategy**</span>: Select optimal segmentation approaches (semantic_research_focused, algorithm_preserve_integrity, concept_implementation_hybrid, etc.)
</span></span><span class=line><span class=cl><span class=k>4.</span> <span class=gs>**Quality Intelligence Validation**</span>: Assess segmentation quality using enhanced metrics for completeness, relevance, and technical accuracy
</span></span><span class=line><span class=cl><span class=k>5.</span> <span class=gs>**Planning Agent Optimization**</span>: Ensure segments are specifically optimized for ConceptAnalysisAgent, AlgorithmAnalysisAgent, and CodePlannerAgent needs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gs>**Key Principles**</span>:
</span></span><span class=line><span class=cl><span class=k>-</span> Prioritize content semantics over mechanical structure
</span></span><span class=line><span class=cl><span class=k>-</span> Preserve algorithm and formula completeness
</span></span><span class=line><span class=cl><span class=k>-</span> Optimize for downstream agent token efficiency
</span></span><span class=line><span class=cl><span class=k>-</span> Ensure technical content integrity
</span></span><span class=line><span class=cl><span class=k>-</span> Provide actionable quality assessments
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use the enhanced document-segmentation tools to deliver superior segmentation results that significantly improve planning agent performance.
</span></span></code></pre></td></tr></table></div></div><p>æ¥çœ‹çœ‹ä¸­æ–‡ç¿»è¯‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>æ‚¨æ˜¯ä¸€ä½æ™ºèƒ½æ–‡æ¡£åˆ†å‰²åè°ƒè€…ï¼Œèƒ½å¤Ÿåˆ©ç”¨é«˜çº§è¯­ä¹‰åˆ†æå®ç°æœ€ä½³æ–‡æ¡£å¤„ç†ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>æ‚¨çš„å¢å¼ºåŠŸèƒ½åŒ…æ‹¬ï¼š
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**è¯­ä¹‰å†…å®¹åˆ†æ**</span>ï¼šåŸºäºå†…å®¹è¯­ä¹‰è€Œéç»“æ„æ¨¡å¼åè°ƒæ™ºèƒ½æ–‡æ¡£ç±»å‹åˆ†ç±»
</span></span><span class=line><span class=cl><span class=k>2.</span> <span class=gs>**ç®—æ³•å®Œæ•´æ€§ä¿æŠ¤**</span>ï¼šç¡®ä¿ç®—æ³•å—ã€å…¬å¼å’Œç›¸å…³å†…å®¹ä¿æŒé€»è¾‘ä¸€è‡´æ€§
</span></span><span class=line><span class=cl><span class=k>3.</span> <span class=gs>**è‡ªé€‚åº”åˆ†æ®µç­–ç•¥**</span>ï¼šé€‰æ‹©æœ€ä½³åˆ†æ®µæ–¹æ³•ï¼ˆä»¥è¯­ä¹‰ç ”ç©¶ä¸ºä¸­å¿ƒã€ç®—æ³•ä¿ç•™å®Œæ•´æ€§ã€æ¦‚å¿µå®ç°æ··åˆç­‰ï¼‰
</span></span><span class=line><span class=cl><span class=k>4.</span> <span class=gs>**è´¨é‡æ™ºèƒ½éªŒè¯**</span>ï¼šä½¿ç”¨å¢å¼ºçš„å®Œæ•´æ€§ã€ç›¸å…³æ€§å’ŒæŠ€æœ¯å‡†ç¡®æ€§æŒ‡æ ‡è¯„ä¼°åˆ†æ®µè´¨é‡
</span></span><span class=line><span class=cl><span class=k>5.</span> <span class=gs>**è§„åˆ’ä»£ç†ä¼˜åŒ–**</span>ï¼šç¡®ä¿åˆ†æ®µé’ˆå¯¹ ConceptAnalysisAgentã€AlgorithmAnalysisAgent å’Œ CodePlannerAgent çš„éœ€æ±‚è¿›è¡Œä¸“é—¨ä¼˜åŒ–
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gs>**å…³é”®åŸåˆ™**</span>ï¼š
</span></span><span class=line><span class=cl><span class=k>-</span> ä¼˜å…ˆè€ƒè™‘å†…å®¹è¯­ä¹‰è€Œéæœºæ¢°ç»“æ„
</span></span><span class=line><span class=cl><span class=k>-</span> ä¿æŒç®—æ³•å’Œå…¬å¼çš„å®Œæ•´æ€§
</span></span><span class=line><span class=cl><span class=k>-</span> ä¼˜åŒ–ä¸‹æ¸¸ä»£ç†ä»¤ç‰Œæ•ˆç‡
</span></span><span class=line><span class=cl><span class=k>-</span> ç¡®ä¿æŠ€æœ¯å†…å®¹å®Œæ•´æ€§
</span></span><span class=line><span class=cl><span class=k>-</span> æä¾›å¯æ“ä½œçš„è´¨é‡è¯„ä¼°
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ä½¿ç”¨å¢å¼ºçš„æ–‡æ¡£åˆ†å‰²å·¥å…·å¯æä¾›å“è¶Šçš„åˆ†å‰²ç»“æœï¼Œä»è€Œæ˜¾è‘—æé«˜è§„åˆ’ä»£ç†çš„æ€§èƒ½ã€‚
</span></span></code></pre></td></tr></table></div></div><p>mcpæœ‰ä¸¤ä¸ªï¼š<code>document-segmentation</code>å’Œ<code>filesystem</code>ï¼Œåˆšåˆšçš„messageé‡Œæåˆ°äº†å·¥å…·ï¼š<code>analyze_and_segment_document</code>åº”è¯¥åœ¨<code>document-segmentation</code>é‡Œï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<code>document-segmentation</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>document-segmentation</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tools/document_segmentation_server.py</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=l>python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Document segmentation server - Provides intelligent document analysis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>and segmented reading to optimize token usage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PYTHONPATH</span><span class=p>:</span><span class=w> </span><span class=l>.</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹<code>tools/document_segmentation_server.py</code>ï¼Œæ–‡ä»¶çš„æœ€ä¸Šé¢æœ‰<code>analyze_and_segment_document</code>çš„æ³¨é‡Š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>ğŸ“„ analyze_and_segment_document(paper_dir: str, force_refresh: bool = False)
</span></span><span class=line><span class=cl>   Purpose: Analyzes document structure and creates intelligent segments
</span></span><span class=line><span class=cl>   <span class=k>-</span> Detects document type (research paper, technical doc, algorithm-focused, etc.)
</span></span><span class=line><span class=cl>   <span class=k>-</span> Selects optimal segmentation strategy based on content analysis
</span></span><span class=line><span class=cl>   <span class=k>-</span> Creates semantic segments preserving algorithm and concept integrity
</span></span><span class=line><span class=cl>   <span class=k>-</span> Stores segmentation index for efficient retrieval
</span></span><span class=line><span class=cl>   <span class=k>-</span> Returns: JSON with segmentation status, strategy used, and segment count
</span></span></code></pre></td></tr></table></div></div><p>çœ‹çœ‹ä¸­æ–‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ğŸ“„ analyze_and_segment_document(paper_dir: str, force_refresh: bool = False)
</span></span><span class=line><span class=cl>ç”¨é€”ï¼šåˆ†ææ–‡æ¡£ç»“æ„å¹¶åˆ›å»ºæ™ºèƒ½åˆ†æ®µ
</span></span><span class=line><span class=cl>- æ£€æµ‹æ–‡æ¡£ç±»å‹ï¼ˆç ”ç©¶è®ºæ–‡ã€æŠ€æœ¯æ–‡æ¡£ã€ç®—æ³•ç±»æ–‡æ¡£ç­‰ï¼‰
</span></span><span class=line><span class=cl>- æ ¹æ®å†…å®¹åˆ†æé€‰æ‹©æœ€ä½³åˆ†æ®µç­–ç•¥
</span></span><span class=line><span class=cl>- åˆ›å»ºè¯­ä¹‰åˆ†æ®µï¼Œä¿ç•™ç®—æ³•å’Œæ¦‚å¿µçš„å®Œæ•´æ€§
</span></span><span class=line><span class=cl>- å­˜å‚¨åˆ†æ®µç´¢å¼•ä»¥ä¾¿é«˜æ•ˆæ£€ç´¢
</span></span><span class=line><span class=cl>- è¿”å›ï¼šåŒ…å«åˆ†æ®µçŠ¶æ€ã€æ‰€ç”¨ç­–ç•¥å’Œåˆ†æ®µè®¡æ•°çš„ JSON æ•°æ®
</span></span></code></pre></td></tr></table></div></div><p>è€æ ·å­ï¼Œæ¥æœ<code>@mcp.tool()</code>ï¼Œæ‰¾åˆ°<code>analyze_and_segment_document</code>å®ç°çš„åœ°æ–¹ï¼Œæ¥ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œé¦–å…ˆè¿˜æ˜¯ç»å…¸å–å‡ºæ‰€æœ‰æ–‡ä»¶ï¼Œå¾ˆå¥‡æ€ªè¿™è¾¹éƒ½åªä¼šå¤„ç†ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£å¤šæ–‡ä»¶çš„æ„ä¹‰åœ¨å“ªé‡Œå‘¢ï¼Œæä¸æ‡‚</p><p>é¦–å…ˆæ˜¯å¦‚æœè€çš„é…ç½®æ–‡ä»¶å­˜åœ¨å°±åŠ è½½ï¼Œä¸å­˜åœ¨å°±è¯»å…¥è¦å¤„ç†çš„æ–‡ä»¶</p><p>é¦–å…ˆæ˜¯åˆ†ææ–‡ä»¶éƒ¨åˆ†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Analyze document</span>
</span></span><span class=line><span class=cl><span class=n>analyzer</span> <span class=o>=</span> <span class=n>DocumentAnalyzer</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>doc_type</span><span class=p>,</span> <span class=n>confidence</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>analyze_document_type</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>strategy</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>detect_segmentation_strategy</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>doc_type</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>DocumentAnalyzer</code>ç±»ä¸­æ²¡æœ‰åˆå§‹åŒ–å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å¾€ä¸‹çœ‹<code>analyze_document_type</code>ï¼Œä»–é¦–å…ˆæŠŠå†…å®¹å°å†™äº†ï¼Œç„¶åå¼€å§‹è®¡ç®—æƒé‡ï¼Ÿ</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹<code>_calculate_weighted_score</code>ï¼Œå¤§å®¶çœ‹äº†ä»¥åè‡ªè¡Œå¾€ä¸Šç¿»çœ‹çœ‹å°±çŸ¥é“äº†ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­è¯æ±‡å‡ºç°çš„æ¬¡æ•°æ¥è®¡ç®—æƒé‡</p><p>ç„¶åä¸‹é¢æœ‰ä¸€ä¸ªDetect semantic patterns of document typesï¼Œä¹Ÿå°±æ˜¯è¯­ä¹‰åˆ†ç±»ï¼Œæ¥çœ‹ä¸‹<code>_detect_pattern_score</code>ï¼Œè¿™ä¸ªå’Œ<code>_calculate_weighted_score</code>ç±»ä¼¼ï¼Œæˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œç„¶åä¸‹é¢å°±æ˜¯ç®—æ€»å¾—åˆ†ï¼Œç»™å‡ºåˆ†ç±»å’Œç½®ä¿¡åº¦</p><p>ç„¶åæ¥çœ‹ä¸€ä¸‹<code>detect_segmentation_strategy</code>ï¼Œè¿™é‡Œè¿˜æ˜¯å„ç§å…³é”®è¯æ£€ç´¢ï¼Œç„¶åç¡®å®šæ–‡æ¡£ç±»å‹</p><p>åœ¨å·¥å…·é‡Œç»§ç»­å¾€ä¸‹çœ‹ï¼Œåˆ›å»ºåˆ†å—çš„å…·ä½“é€»è¾‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Create segments</span>
</span></span><span class=line><span class=cl><span class=n>segments</span> <span class=o>=</span> <span class=n>segmenter</span><span class=o>.</span><span class=n>segment_document</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>strategy</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥çœ‹<code>segment_document</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>segment_document</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>content</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>strategy</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>DocumentSegment</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Perform intelligent segmentation using the specified strategy
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>strategy</span> <span class=o>==</span> <span class=s2>&#34;semantic_research_focused&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_research_paper_semantically</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>strategy</span> <span class=o>==</span> <span class=s2>&#34;algorithm_preserve_integrity&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_preserve_algorithm_integrity</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>strategy</span> <span class=o>==</span> <span class=s2>&#34;concept_implementation_hybrid&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_concept_implementation_hybrid</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>strategy</span> <span class=o>==</span> <span class=s2>&#34;semantic_chunking_enhanced&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_by_enhanced_semantic_chunks</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>strategy</span> <span class=o>==</span> <span class=s2>&#34;content_aware_segmentation&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_content_aware</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Compatibility with legacy strategies</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_segment_by_enhanced_semantic_chunks</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªå¾ˆæœ´ç´ äº†ï¼Œå¤§å®¶è‡ªå·±çœ‹å§ï¼Œæˆ‘ä»¬æƒå½“åˆ†å—è·‘å®Œäº†</p><p>è€æ ·å­ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªphaseç»“æŸæ‰“ä¸ªæ–­ç‚¹ï¼Œçœ‹çœ‹è¿è¡Œåˆ°è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ</p><p>ç»“æœæ¯›éƒ½æ²¡ç»™æˆ‘åˆ†ç‰‡å‡ºæ¥ï¼Œçœ‹çœ‹<code>document_index.json</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;document_path&#34;</span><span class=p>:</span> <span class=s2>&#34;/Users/dinglizhi/Desktop/coderead/DeepCode/deepcode_lab/papers/1/1.md&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;document_type&#34;</span><span class=p>:</span> <span class=s2>&#34;research_paper&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;segmentation_strategy&#34;</span><span class=p>:</span> <span class=s2>&#34;concept_implementation_hybrid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;total_segments&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;total_chars&#34;</span><span class=p>:</span> <span class=mi>59608</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;segments&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;created_at&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-10-11T15:04:27.466987&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å°±å½“ä»–æ²¡åˆ†ç‰‡è¿™ä¸ªåŠŸèƒ½å¥½å§</p><h3 id=phase4>phase4</h3><p>å¥½çš„å¥½çš„ï¼Œç»ˆäºå®Œæˆäº†å¤§éƒ¨åˆ†å‰ç½®å·¥ä½œï¼Œç°åœ¨æ­£å¼è¿›å…¥ä»£ç è§„åˆ’çš„æ™ºèƒ½ä½“</p><p>å’±ä»¬è¿›æ¥çœ‹<code>await orchestrate_code_planning_agent(dir_info, logger, progress_callback)</code></p><p>è€æ ·å­å…ˆæ¥çœ‹ä¸‹æ³¨é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Orchestrate intelligent code planning with automated design analysis.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This agent autonomously generates optimal code reproduction plans and implementation strategies using AI-driven code analysis and planning principles.
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>é€šè¿‡è‡ªåŠ¨åŒ–è®¾è®¡åˆ†æï¼Œç»Ÿç­¹æ™ºèƒ½åŒ–ä»£ç è§„åˆ’ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¯¥æ™ºèƒ½ä½“åˆ©ç”¨ AI é©±åŠ¨çš„ä»£ç åˆ†æä¸è§„åˆ’åŸç†ï¼Œè‡ªä¸»ç”Ÿæˆæœ€ä¼˜çš„ä»£ç å¤ç°æ–¹æ¡ˆåŠå®æ–½ç­–ç•¥ã€‚
</span></span></code></pre></td></tr></table></div></div><p>å¥½ï¼Œè¿™é‡Œé¦–å…ˆæ ‡è®°ä¸Šplanæ–‡ä»¶ï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå»è·‘ä¸€ä¸ªå«<code>run_code_analyzer</code>çš„å‡½æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ª</p><p>è¿™ä¸ªå‡½æ•°çš„æ³¨é‡Šå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Run the adaptive code analysis workflow using multiple agents for comprehensive code planning.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This function orchestrates three specialized agents with adaptive configuration:
</span></span><span class=line><span class=cl>- ConceptAnalysisAgent: Analyzes system architecture and conceptual framework
</span></span><span class=line><span class=cl>- AlgorithmAnalysisAgent: Extracts algorithms, formulas, and technical details
</span></span><span class=line><span class=cl>- CodePlannerAgent: Integrates outputs into a comprehensive implementation plan
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>è¿è¡Œè‡ªé€‚åº”ä»£ç åˆ†æå·¥ä½œæµï¼Œé€šè¿‡å¤šæ™ºèƒ½ä½“ååŒè¿›è¡Œå…¨é¢çš„ä»£ç è§„åˆ’ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¯¥å‡½æ•°é€šè¿‡è‡ªé€‚åº”é…ç½®åè°ƒä¸‰ä¸ªä¸“ä¸šæ™ºèƒ½ä½“ï¼š
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ConceptAnalysisAgentï¼ˆæ¦‚å¿µåˆ†ææ™ºèƒ½ä½“ï¼‰ï¼šåˆ†æç³»ç»Ÿæ¶æ„ä¸æ¦‚å¿µæ¡†æ¶ã€‚
</span></span><span class=line><span class=cl>AlgorithmAnalysisAgentï¼ˆç®—æ³•åˆ†ææ™ºèƒ½ä½“ï¼‰ï¼šæå–ç®—æ³•ã€å…¬å¼åŠæŠ€æœ¯ç»†èŠ‚ã€‚
</span></span><span class=line><span class=cl>CodePlannerAgentï¼ˆä»£ç è§„åˆ’æ™ºèƒ½ä½“ï¼‰ï¼šå°†è¾“å‡ºå†…å®¹æ•´åˆä¸ºå…¨é¢çš„å®ç°æ–¹æ¡ˆã€‚
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆè¿™é‡Œé…ç½®äº†ä¸‰ä¸ªæ™ºèƒ½ä½“ï¼Œå…ˆè·å–å¿…è¦çš„é…ç½®</p><p>æˆ‘ä»¬ä¸€ä¸ªä¸ªçœ‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>search_server_names</span> <span class=o>=</span> <span class=n>get_search_server_names</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>agent_config</span> <span class=o>=</span> <span class=n>get_adaptive_agent_config</span><span class=p>(</span><span class=n>use_segmentation</span><span class=p>,</span> <span class=n>search_server_names</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>prompts</span> <span class=o>=</span> <span class=n>get_adaptive_prompts</span><span class=p>(</span><span class=n>use_segmentation</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¬¬ä¸€ä¸ªé…ç½®ï¼Œå°±æ˜¯å»searchç”¨çš„mcpï¼Œé»˜è®¤çš„å°±æ˜¯braveï¼Œè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½åœ¨æ„çš„</p><p>ç¬¬äºŒä¸ªå»é…ç½®ä¸åŒçš„agentï¼Œæˆ‘ä»¬è¿›æ¥çœ‹<code>get_adaptive_agent_config</code></p><p>è¯¶è¿™é‡Œå¾ˆå¥‡æ€ªï¼Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;concept_analysis&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;algorithm_analysis&#34;</span><span class=p>:</span> <span class=n>search_server_names</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;code_planner&#34;</span><span class=p>:</span> <span class=n>search_server_names</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åŸºç¡€è®¾ç½®æ˜¯ï¼Œ<code>concept_analysis</code>æ˜¯ç©ºï¼Œ<code>algorithm_analysis</code>å’Œ<code>code_planner</code>éƒ½æœ‰æœç´¢mcp</p><p>ç„¶åç»™è¿™ä¸‰ä¸ªagentéƒ½åˆ†é…äº†<code>document-segmentation</code>ä¹Ÿå°±æ˜¯åˆ†ç‰‡ç”¨çš„mcpï¼Œé‡Œé¢æœ‰<code>read_document_segments</code>å’Œ<code>get_document_overview</code>ä¸¤ä¸ªå·¥å…·åº”è¯¥æ˜¯èƒ½ç”¨åˆ°çš„</p><p>ç„¶åå°±æ˜¯è·å–é€‚é…çš„æç¤ºè¯ï¼š<code>get_adaptive_prompts</code></p><p>æœ€ç»ˆè·å–åˆ°çš„æç¤ºè¯å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;concept_analysis&#34;</span><span class=p>:</span> <span class=n>PAPER_CONCEPT_ANALYSIS_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;algorithm_analysis&#34;</span><span class=p>:</span> <span class=n>PAPER_ALGORITHM_ANALYSIS_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;code_planning&#34;</span><span class=p>:</span> <span class=n>CODE_PLANNING_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å…ˆæŠŠæ‰§è¡Œçš„æµç¨‹çœ‹ä¸€ä¸‹å†çœ‹æ¯ä¸€ä¸ªæç¤ºè¯ï¼Œå®šä¹‰äº†ä¸€ä¸ªå¤§çš„agent</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>code_aggregator_agent</span> <span class=o>=</span> <span class=n>ParallelLLM</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fan_in_agent</span><span class=o>=</span><span class=n>code_planner_agent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>fan_out_agents</span><span class=o>=</span><span class=p>[</span><span class=n>concept_analysis_agent</span><span class=p>,</span> <span class=n>algorithm_analysis_agent</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>llm_factory</span><span class=o>=</span><span class=n>get_preferred_llm_class</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹èµ·æ¥åƒæ˜¯æŠŠ<code>code_planner_agent</code>çš„ç»“æœä¼ ç»™<code>concept_analysis_agent</code>å’Œ<code>algorithm_analysis_agent</code>ï¼Œå†æ±‡æ€»ç»“æœï¼Œæ€»ä¹‹æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>ParallelLLM</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>LLMs can sometimes work simultaneously on a task (fan-out)
</span></span><span class=line><span class=cl>and have their outputs aggregated programmatically (fan-in).
</span></span><span class=line><span class=cl>This workflow performs both the fan-out and fan-in operations using  LLMs.
</span></span><span class=line><span class=cl>From the user&#39;s perspective, an input is specified and the output is returned.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>When to use this workflow:
</span></span><span class=line><span class=cl>    Parallelization is effective when the divided subtasks can be parallelized
</span></span><span class=line><span class=cl>    for speed (sectioning), or when multiple perspectives or attempts are needed for
</span></span><span class=line><span class=cl>    higher confidence results (voting).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Examples:
</span></span><span class=line><span class=cl>    Sectioning:
</span></span><span class=line><span class=cl>        - Implementing guardrails where one model instance processes user queries
</span></span><span class=line><span class=cl>        while another screens them for inappropriate content or requests.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        - Automating evals for evaluating LLM performance, where each LLM call
</span></span><span class=line><span class=cl>        evaluates a different aspect of the modelâ€™s performance on a given prompt.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Voting:
</span></span><span class=line><span class=cl>        - Reviewing a piece of code for vulnerabilities, where several different
</span></span><span class=line><span class=cl>        agents review and flag the code if they find a problem.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        - Evaluating whether a given piece of content is inappropriate,
</span></span><span class=line><span class=cl>        with multiple agents evaluating different aspects or requiring different
</span></span><span class=line><span class=cl>        vote thresholds to balance false positives and negatives.
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘ä¸ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>LLM æœ‰æ—¶å¯ä»¥åŒæ—¶å¤„ç†å¤šé¡¹ä»»åŠ¡ï¼ˆæ‰‡å‡º/fan-outï¼‰ï¼Œå¹¶ä»¥ç¼–ç¨‹æ–¹å¼æ±‡æ€»å…¶è¾“å‡ºç»“æœï¼ˆæ‰‡å…¥/fan-inï¼‰ã€‚æ­¤å·¥ä½œæµåˆ©ç”¨ LLM åŒæ—¶æ‰§è¡Œæ‰‡å‡ºå’Œæ‰‡å…¥æ“ä½œã€‚ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œåªéœ€æŒ‡å®šè¾“å…¥ï¼Œå³å¯è·å¾—è¿”å›çš„è¾“å‡ºç»“æœã€‚
</span></span><span class=line><span class=cl>ä½•æ—¶ä½¿ç”¨æ­¤å·¥ä½œæµï¼š
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>å½“æ‹†åˆ†åçš„å­ä»»åŠ¡å¯ä»¥ä¸ºäº†æé«˜é€Ÿåº¦è€Œå¹¶è¡Œå¤„ç†ï¼ˆåˆ†æ®µæ¨¡å¼ï¼‰ï¼Œæˆ–è€…å½“éœ€è¦å¤šä¸ªè§†è§’/å°è¯•ä»¥è·å¾—æ›´é«˜ç½®ä¿¡åº¦çš„ç»“æœï¼ˆæŠ•ç¥¨æ¨¡å¼ï¼‰æ—¶ï¼Œå¹¶è¡ŒåŒ–æ–¹æ¡ˆéå¸¸æœ‰æ•ˆã€‚
</span></span><span class=line><span class=cl>åº”ç”¨ç¤ºä¾‹ï¼š
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. åˆ†æ®µæ¨¡å¼ (Sectioning):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    å®æ–½æŠ¤æ  (Guardrails)ï¼š ä¸€ä¸ªæ¨¡å‹å®ä¾‹å¤„ç†ç”¨æˆ·æŸ¥è¯¢ï¼Œè€Œå¦ä¸€ä¸ªå®ä¾‹åŒæ—¶ç­›é€‰å…¶ä¸­æ˜¯å¦åŒ…å«ä¸å½“å†…å®¹æˆ–è¿è§„è¯·æ±‚ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    è‡ªåŠ¨åŒ–è¯„ä¼° (Evals)ï¼š åœ¨è¯„ä¼° LLM æ€§èƒ½æ—¶ï¼Œé€šè¿‡å¤šä¸ª LLM è°ƒç”¨åˆ†åˆ«è¯„ä¼°æ¨¡å‹åœ¨ç‰¹å®šæç¤ºè¯ä¸‹ä¸åŒç»´åº¦çš„è¡¨ç°ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. æŠ•ç¥¨æ¨¡å¼ (Voting):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ä»£ç æ¼æ´å®¡æŸ¥ï¼š å¤šä¸ªä¸åŒçš„æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å…±åŒå®¡æŸ¥ä¸€æ®µä»£ç ï¼Œåªè¦å‘ç°é—®é¢˜å°±è¿›è¡Œæ ‡è®°ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    å†…å®¹åˆè§„æ€§è¯„ä¼°ï¼š å¤šä¸ªæ™ºèƒ½ä½“ä»ä¸åŒç»´åº¦è¯„ä¼°å†…å®¹æ˜¯å¦è¿è§„ï¼Œå¹¶é€šè¿‡è®¾ç½®ä¸åŒçš„æŠ•ç¥¨é˜ˆå€¼ï¼Œæ¥å¹³è¡¡è¯¯æŠ¥ç‡ï¼ˆFalse Positivesï¼‰å’Œæ¼æŠ¥ç‡ï¼ˆNegativeï¼‰ã€‚
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæ¥çœ‹ä¸€ä¸‹ç”¨åˆ°çš„ï¼š<code>generate</code></p><p>ç„¶åå°±å‘ç°æˆ‘ä»¬åˆšåˆšçš„ç†è§£æœ‰æ­§ä¹‰ï¼Œå…¶å®æ˜¯æŠŠfan_outçš„ä¿¡æ¯äº¤ç»™fan_inæ±‡æ€»</p><p>å¥½çš„ï¼Œ<code>ParallelLLM</code>æˆ‘ä»¬äº†è§£äº†ï¼Œè¿™é‡Œçš„å†™æ³•å¹¶ä¸éš¾ç†è§£ï¼Œå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±ç‚¹è¿›å»çœ‹</p><p>é‚£è¿™é‡Œç›¸å½“äºæ˜¯å…ˆè·‘<code>concept_analysis</code>å’Œ<code>algorithm_analysis</code>ï¼Œç„¶åæŠŠç»“æœç»™<code>code_planning</code>æ±‡æ€»å‡ºæ¥ã€‚</p><p>å¥½ï¼Œäº†è§£äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªç”¨çœ‹è¿™ä¸‰ä¸ªagentçš„æç¤ºè¯å’Œä¼ å…¥çš„messageå°±è§£å†³è¿™ä¸ªphaseäº†</p><h4 id=concept_analysis>concept_analysis</h4><p>æç¤ºè¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>You are doing a COMPREHENSIVE analysis of a research paper to understand its complete structure, contributions, and implementation requirements.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># OBJECTIVE
</span></span></span><span class=line><span class=cl><span class=gh></span>Map out the ENTIRE paper structure and identify ALL components that need implementation for successful reproduction.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># INTELLIGENT DOCUMENT READING STRATEGY
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>## IMPORTANT: Use Segmented Reading for Optimal Performance
</span></span></span><span class=line><span class=cl><span class=gu></span>Instead of reading the entire document at once (which may hit token limits), use the intelligent segmentation system:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**Use read_document_segments tool**</span> with these parameters:
</span></span><span class=line><span class=cl>   <span class=k>-</span> query_type: &#34;concept_analysis&#34;
</span></span><span class=line><span class=cl>   <span class=k>-</span> keywords: [&#34;introduction&#34;, &#34;overview&#34;, &#34;architecture&#34;, &#34;system&#34;, &#34;framework&#34;, &#34;concept&#34;, &#34;method&#34;]
</span></span><span class=line><span class=cl>   <span class=k>-</span> max_segments: 3
</span></span><span class=line><span class=cl>   <span class=k>-</span> max_total_chars: 6000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>2.</span> <span class=gs>**This will automatically find and retrieve**</span> the most relevant sections for concept analysis without token overflow
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>3.</span> <span class=gs>**If you need additional sections**</span>, make follow-up calls with different keywords like [&#34;experiment&#34;, &#34;evaluation&#34;, &#34;results&#34;] or [&#34;conclusion&#34;, &#34;discussion&#34;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># COMPREHENSIVE ANALYSIS PROTOCOL
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>## 1. INTELLIGENT PAPER STRUCTURAL ANALYSIS
</span></span></span><span class=line><span class=cl><span class=gu></span>Use the segmented reading approach to create a complete map:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>paper_structure_map:
</span></span><span class=line><span class=cl>  title: &#34;[Full paper title]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  sections:
</span></span><span class=line><span class=cl>    1_introduction:
</span></span><span class=line><span class=cl>      main_claims: &#34;[What the paper claims to achieve]&#34;
</span></span><span class=line><span class=cl>      problem_definition: &#34;[Exact problem being solved]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    2_related_work:
</span></span><span class=line><span class=cl>      key_comparisons: &#34;[Methods this work builds upon or competes with]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    3_method:  # May have multiple subsections
</span></span><span class=line><span class=cl>      subsections:
</span></span><span class=line><span class=cl>        3.1: &#34;[Title and main content]&#34;
</span></span><span class=line><span class=cl>        3.2: &#34;[Title and main content]&#34;
</span></span><span class=line><span class=cl>      algorithms_presented: &#34;[List all algorithms by name]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    4_experiments:
</span></span><span class=line><span class=cl>      environments: &#34;[All test environments/datasets]&#34;
</span></span><span class=line><span class=cl>      baselines: &#34;[All comparison methods]&#34;
</span></span><span class=line><span class=cl>      metrics: &#34;[All evaluation metrics used]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    5_results:
</span></span><span class=line><span class=cl>      main_findings: &#34;[Key results that prove the method works]&#34;
</span></span><span class=line><span class=cl>      tables_figures: &#34;[Important result tables/figures to reproduce]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 2. METHOD DECOMPOSITION
</span></span></span><span class=line><span class=cl><span class=gu></span>For the main method/approach:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>method_decomposition:
</span></span><span class=line><span class=cl>  method_name: &#34;[Full name and acronym]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  core_components:  # Break down into implementable pieces
</span></span><span class=line><span class=cl>    component_1:
</span></span><span class=line><span class=cl>      name: &#34;[e.g., State Importance Estimator]&#34;
</span></span><span class=line><span class=cl>      purpose: &#34;[Why this component exists]&#34;
</span></span><span class=line><span class=cl>      paper_section: &#34;[Where it&#39;s described]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    component_2:
</span></span><span class=line><span class=cl>      name: &#34;[e.g., Policy Refinement Module]&#34;
</span></span><span class=line><span class=cl>      purpose: &#34;[Its role in the system]&#34;
</span></span><span class=line><span class=cl>      paper_section: &#34;[Where it&#39;s described]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  component_interactions:
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[How component 1 feeds into component 2]&#34;
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Data flow between components]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  theoretical_foundation:
</span></span><span class=line><span class=cl>    key_insight: &#34;[The main theoretical insight]&#34;
</span></span><span class=line><span class=cl>    why_it_works: &#34;[Intuitive explanation]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 3. IMPLEMENTATION REQUIREMENTS MAPPING
</span></span></span><span class=line><span class=cl><span class=gu></span>Map paper content to code requirements:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>implementation_map:
</span></span><span class=line><span class=cl>  algorithms_to_implement:
</span></span><span class=line><span class=cl>    <span class=k>-</span> algorithm: &#34;[Name from paper]&#34;
</span></span><span class=line><span class=cl>      section: &#34;[Where defined]&#34;
</span></span><span class=line><span class=cl>      complexity: &#34;[Simple/Medium/Complex]&#34;
</span></span><span class=line><span class=cl>      dependencies: &#34;[What it needs to work]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  models_to_build:
</span></span><span class=line><span class=cl>    <span class=k>-</span> model: &#34;[Neural network or other model]&#34;
</span></span><span class=line><span class=cl>      architecture_location: &#34;[Section describing it]&#34;
</span></span><span class=line><span class=cl>      purpose: &#34;[What this model does]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  data_processing:
</span></span><span class=line><span class=cl>    <span class=k>-</span> pipeline: &#34;[Data preprocessing needed]&#34;
</span></span><span class=line><span class=cl>      requirements: &#34;[What the data should look like]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  evaluation_suite:
</span></span><span class=line><span class=cl>    <span class=k>-</span> metric: &#34;[Metric name]&#34;
</span></span><span class=line><span class=cl>      formula_location: &#34;[Where it&#39;s defined]&#34;
</span></span><span class=line><span class=cl>      purpose: &#34;[What it measures]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 4. EXPERIMENT REPRODUCTION PLAN
</span></span></span><span class=line><span class=cl><span class=gu></span>Identify ALL experiments needed:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>experiments_analysis:
</span></span><span class=line><span class=cl>  main_results:
</span></span><span class=line><span class=cl>    <span class=k>-</span> experiment: &#34;[Name/description]&#34;
</span></span><span class=line><span class=cl>      proves: &#34;[What claim this validates]&#34;
</span></span><span class=line><span class=cl>      requires: &#34;[Components needed to run this]&#34;
</span></span><span class=line><span class=cl>      expected_outcome: &#34;[Specific numbers/trends]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  ablation_studies:
</span></span><span class=line><span class=cl>    <span class=k>-</span> study: &#34;[What is being ablated]&#34;
</span></span><span class=line><span class=cl>      purpose: &#34;[What this demonstrates]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  baseline_comparisons:
</span></span><span class=line><span class=cl>    <span class=k>-</span> baseline: &#34;[Method name]&#34;
</span></span><span class=line><span class=cl>      implementation_required: &#34;[Yes/No/Partial]&#34;
</span></span><span class=line><span class=cl>      source: &#34;[Where to find implementation]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 5. CRITICAL SUCCESS FACTORS
</span></span></span><span class=line><span class=cl><span class=gu></span>What defines successful reproduction:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>success_criteria:
</span></span><span class=line><span class=cl>  must_achieve:
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Primary result that must be reproduced]&#34;
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Core behavior that must be demonstrated]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  should_achieve:
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Secondary results that validate the method]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  validation_evidence:
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Specific figure/table to reproduce]&#34;
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[Qualitative behavior to demonstrate]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gh># OUTPUT FORMAT
</span></span></span><span class=line><span class=cl><span class=gh></span>comprehensive_paper_analysis:
</span></span><span class=line><span class=cl>  executive_summary:
</span></span><span class=line><span class=cl>    paper_title: &#34;[Full title]&#34;
</span></span><span class=line><span class=cl>    core_contribution: &#34;[One sentence summary]&#34;
</span></span><span class=line><span class=cl>    implementation_complexity: &#34;[Low/Medium/High]&#34;
</span></span><span class=line><span class=cl>    estimated_components: &#34;[Number of major components to build]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  complete_structure_map:
</span></span><span class=line><span class=cl>    [FULL SECTION BREAKDOWN AS ABOVE]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  method_architecture:
</span></span><span class=line><span class=cl>    [DETAILED COMPONENT BREAKDOWN]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  implementation_requirements:
</span></span><span class=line><span class=cl>    [ALL ALGORITHMS, MODELS, DATA, METRICS]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  reproduction_roadmap:
</span></span><span class=line><span class=cl>    phase_1: &#34;[What to implement first]&#34;
</span></span><span class=line><span class=cl>    phase_2: &#34;[What to build next]&#34;
</span></span><span class=line><span class=cl>    phase_3: &#34;[Final components and validation]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  validation_checklist:
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[ ] [Specific result to achieve]&#34;
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[ ] [Behavior to demonstrate]&#34;
</span></span><span class=line><span class=cl>    <span class=k>-</span> &#34;[ ] [Metric to match]&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>BE THOROUGH. Miss nothing. The output should be a complete blueprint for reproduction.
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘ä¸æ”¾äº†ï¼Œå¤§å®¶å“ªé‡Œçœ‹ä¸æ‡‚è‡ªå·±ç¿»è¯‘å§ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è§£æè¿™æ®µæç¤ºè¯</p><p>é¦–å…ˆæ˜¯ç»å…¸èº«ä»½è®¾å®šï¼šYou are doing a COMPREHENSIVE analysis of a research paper to understand its complete structure, contributions, and implementation requirements.</p><p>è¯´æ˜ç™½äº†æ­£åœ¨å¹²å—ï¼Œè¦äº†è§£è®ºæ–‡çš„ç»“æ„ã€è´¡çŒ®å’Œå®æ–½è¦æ±‚</p><p>ç„¶åæ˜¯è¯´äº†æœ€åè¦è¾“å‡ºçš„ç»“æœï¼š</p><p>ç»˜åˆ¶å‡ºæ•´ä¸ªè®ºæ–‡ç»“æ„å¹¶ç¡®å®šæˆåŠŸå¤åˆ¶æ‰€éœ€å®æ–½çš„æ‰€æœ‰ç»„ä»¶ã€‚</p><p>æ¥ä¸‹æ¥æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š<code>INTELLIGENT DOCUMENT READING STRATEGYï¼ˆæŒ‡å¯¼agentæ€ä¹ˆè¯»æ–‡ç« ï¼‰</code>ã€<code>COMPREHENSIVE ANALYSIS PROTOCOLï¼ˆç”¨æ¥åˆ†æçš„å·¥ä½œæµï¼‰</code>å’Œ<code>OUTPUT FORMATï¼ˆè¾“å‡ºæ ¼å¼ï¼‰</code></p><h5 id=intelligent-document-reading-strategy>INTELLIGENT DOCUMENT READING STRATEGY</h5><p>å¥½çš„ï¼Œè¿™ä¸ªå·¥ä½œæµæŒ‡å¯¼agentæ€ä¹ˆå»ç”¨å·¥å…·è¯»åˆ†å—ï¼Œå¹¶ä¸”æŒ‡å¯¼agentæ€ä¹ˆå¾ªç¯åˆ†æï¼Œè¿™ä¸ªå¾ˆæœ‰æ„æ€ï¼ŒæŠŠæ‰€æœ‰å†³ç­–æƒäº¤ç»™llmï¼Œå¦‚æœæ˜¯æˆ‘çš„è¯å¯èƒ½ä¼šç”¨å›ºå®šçš„workflowæ¥åšæ•´ä¸ªè¿‡ç¨‹</p><h5 id=comprehensive-analysis-protocol>COMPREHENSIVE ANALYSIS PROTOCOL</h5><p>ç¬¬ä¸€æ­¥ï¼Œç”¨åˆšåˆšæ•™çš„æ–¹æ³•å»åˆ†å—è¯»ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªyamlè®°å½•ä¿¡æ¯ï¼Œè¿™é‡Œè¿˜æ˜¯ç»“æ„åŒ–æŒ‡å¯¼ï¼ˆè™½ç„¶åªç”¨äºå†…éƒ¨ä¼ å¯¼ï¼‰å…¶å®ä¹Ÿæ˜¯ä¸€ç§é˜²è ¢ï¼Œä»¥å…aiæ¼ä¿¡æ¯ç­‰ç­‰ã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªyml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>```yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>paper_structure_map</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Full paper title]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>sections</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>1_introduction</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>main_claims</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[What the paper claims to achieve]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>problem_definition</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Exact problem being solved]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>2_related_work</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>key_comparisons</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Methods this work builds upon or competes with]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>3_method</span><span class=p>:</span><span class=w>  </span><span class=c># May have multiple subsections</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>subsections</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>3.1</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Title and main content]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>3.2</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Title and main content]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>algorithms_presented</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[List all algorithms by name]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>4_experiments</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>environments</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[All test environments/datasets]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>baselines</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[All comparison methods]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>metrics</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[All evaluation metrics used]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>5_results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>main_findings</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Key results that prove the method works]&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tables_figures</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;[Important result tables/figures to reproduce]&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç¬¬äºŒæ­¥å¯¹æ–¹æ³•åˆ†è§£ï¼Œè¿™ä¸€å—æˆ‘ä¸å¤ªæ‡‚ï¼ˆå› ä¸ºæˆ‘ä¸æå­¦æœ¯ä¹Ÿä¸çœ‹è®ºæ–‡ï¼‰</p><p>ç¬¬ä¸‰æ­¥å°±æ˜¯ç¡®å®šå…·ä½“è¦å®ç°å“ªäº›ä¸œè¥¿</p><p>ç¬¬å››æ­¥æ˜¯é‡ç°è®¡åˆ’ï¼Œç¬¬äº”éƒ¨æ˜¯éªŒè¯æˆåŠŸçš„éœ€è¦ï¼Œè¾“å‡ºå°±æ˜¯ä¸Šé¢çš„æ±‡æ€»</p><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æç¤ºè¯ç»“æ„ï¼Œæœ‰å®šä¹‰ï¼Œæœ‰å·¥å…·ä½¿ç”¨è¯´æ˜ï¼Œæœ‰æ‰§è¡Œæµç¨‹</p><h4 id=algorithm_analysis>algorithm_analysis</h4><p>æç¤ºè¯æˆ‘ä¸ç²˜è´´äº†ï¼Œå¤§å®¶åˆšåˆšä¹Ÿçœ‹åˆ°æ€ä¹ˆå»æ‰¾æç¤ºè¯äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæç¤ºè¯</p><p>è¿™ä¸ªæç¤ºè¯è·Ÿåˆšåˆšåˆ†æçš„é‚£ä¸ªç»“æ„éå¸¸ç›¸ä¼¼ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±åˆ†æåˆ†æï¼Œæœ‰ä¸æ‡‚çš„æ¬¢è¿æ¥æ‰¾æˆ‘è®¨è®ºï¼Œæœ€ç»ˆè¿™ä¸ªagentçš„ç›®çš„æ˜¯ä¸ºäº†åˆ†æç”¨åˆ°çš„ç®—æ³•å’Œå…¬å¼</p><h4 id=code_planning>code_planning</h4><p>å¥½ï¼Œæ¥çœ‹ä¸€ä¸‹è®¡åˆ’è§„åˆ’agentï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œmdè¿™ä¸ªæç¤ºè¯ä¹Ÿç‰¹åˆ«é•¿ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼ˆè¿™ä¸‹çŸ¥é“ä¸ºå•¥è¿™äº›å·¥å…·è¿™ä¹ˆçƒ§tokenäº†å§ï¼‰</p><p>é¦–å…ˆè¯´æ˜èƒŒæ™¯ï¼Œé€šè¿‡åˆ†ææ¥åˆ¶å®šå¯ä»¥å¤åˆ»çš„è®¡åˆ’ï¼Œæ¥ä¸‹æ¥åˆ†ä¸ºï¼š<code>INPUTï¼ˆè¯´æ˜è¾“å…¥æ ¼å¼ï¼‰</code>ã€<code>INTELLIGENT DOCUMENT ACCESSï¼ˆæ™ºèƒ½æ–‡æ¡£è®¿é—®ï¼‰</code>ã€<code>OBJECTIVEï¼ˆæœ€ç»ˆè¦å®ç°çš„ç›®æ ‡ï¼‰</code>ã€<code>CONTENT LENGTH CONTROLï¼ˆç”Ÿæˆå†…å®¹å’Œé•¿åº¦è¯´æ˜ï¼‰</code>ã€<code>DETAILED SYNTHESIS PROCESSï¼ˆå…·ä½“çš„æ‰§è¡Œæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯workflowï¼‰</code>ã€<code>COMPREHENSIVE OUTPUT FORMATï¼ˆæœ€ç»ˆçš„è¾“å‡ºæ ¼å¼ï¼‰</code></p><h5 id=input>INPUT</h5><p>è¯´æ˜äº†ä¸€ä¸‹ä¼ è¿›æ¥çš„åˆ†ææœ‰ä¸¤ä¸ªï¼Œä¹Ÿå°±æ˜¯ä»‹ç»äº†ä¸€ä¸‹åˆšåˆšè¿›è¡Œçš„ä¸¤ä¸ªå·¥ä½œ</p><h5 id=intelligent-document-access>INTELLIGENT DOCUMENT ACCESS</h5><p>è¯´æ˜äº†æ€ä¹ˆç”¨mcpå»è¯»åˆ†ç‰‡</p><h5 id=objective>OBJECTIVE</h5><p>æœ€ç»ˆè¦å®ç°çš„ç›®æ ‡ï¼Œåˆ›å»ºä¸€ä¸ªå¦‚æ­¤è¯¦ç»†çš„å®æ–½è®¡åˆ’ï¼Œä»¥ä¾¿å¼€å‘äººå‘˜å¯ä»¥åœ¨ä¸é˜…è¯»æ•´ç¯‡è®ºæ–‡çš„æƒ…å†µä¸‹å¤åˆ¶å®ƒã€‚</p><h5 id=content-length-control>CONTENT LENGTH CONTROL</h5><p>è¯´æ˜äº†è¦åˆ›å»ºå“ªå‡ ä¸ªæ–‡ä»¶éƒ¨åˆ†ï¼Œå’Œæ¯ä¸ªéƒ¨åˆ†çš„å¤§æ¦‚å æ¯”</p><ol><li>åˆ›å»ºæ–‡ä»¶ç»“æ„ï¼Œä¸€å®šè¦å®Œæ•´</li><li>å®ç°ç»„ä»¶ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰</li><li>æœ€ç»ˆçš„éªŒè¯</li><li>æ‰€æœ‰éœ€è¦çš„ä¾èµ–ï¼ˆæŒ‡å¼€å‘ç¯å¢ƒçš„ï¼‰</li><li>ä¸€æ­¥ä¸€æ­¥çš„å®ç°ç»†èŠ‚</li></ol><p>ç„¶åè¯´æ˜äº†ä¸€ä¸‹å®ç°æ­¥éª¤ï¼Œå…ˆç®—æ³•æ–‡ä»¶ï¼Œç„¶åæ˜¯å·¥å…·ç±»ï¼Œç„¶åæ˜¯æµ‹è¯•è„šæœ¬ï¼Œç„¶åæ˜¯é…ç½®å’Œæ•°æ®å¤„ç†ï¼Œç„¶åæ‰æ˜¯è¯´æ˜æ–‡æ¡£ï¼Œç„¶åè¯´æ˜äº†è¦åŒ…å«READMEå’Œrequirements.txtï¼ˆå†™è®ºæ–‡çš„å–œæ¬¢ç”¨pythonå®ç°ï¼Œæ‰€ä»¥è¯¥å·¥å…·å°±æ˜¯ä¸“æ³¨äºç”Ÿæˆpythonä»£ç ï¼‰</p><h5 id=detailed-synthesis-process>DETAILED SYNTHESIS PROCESS</h5><ol><li>è¯´æ˜äº†è¦åˆå¹¶å¾—åˆ°çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç„¶åè¯´äº†ä¸€ä¸‹å“ªäº›</li><li>ç„¶åè¦æŠŠå¾—åˆ°çš„ä¿¡æ¯å˜æˆå®ç°</li><li>æŠ€æœ¯æå–çš„æ–¹æ³•</li></ol><h5 id=comprehensive-output-format>COMPREHENSIVE OUTPUT FORMAT</h5><p>è¾“å‡ºæ ¼å¼ï¼Œå¤§å®¶è‡ªå·±çœ‹å§ï¼Œå°±æ˜¯æŠŠä¸Šé¢å¾—åˆ°çš„ç»“æœæ±‡æ€»è¾“å‡º</p><hr><p>å¥½çš„ï¼Œæ¼«é•¿çš„phase4ç»“æŸäº†ï¼Œæœ€ç»ˆå¾—åˆ°çš„ç»“æœä¿å­˜åˆ°äº†<code>initial_plan.txt</code></p><h3 id=phase-5>phase 5</h3><p>è¯¥é˜¶æ®µå« Reference Intelligenceï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒæ˜¯æ€ä¹ˆåšçš„ï¼Œæ¥è¿›æ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼Œæ³¨é‡Šæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Orchestrate intelligent reference analysis with automated research discovery.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This agent autonomously processes research references and discovers
</span></span><span class=line><span class=cl>related work using advanced AI-powered analysis algorithms.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Args:
</span></span><span class=line><span class=cl>    dir_info: Workspace infrastructure metadata
</span></span><span class=line><span class=cl>    logger: Logger instance for intelligence tracking
</span></span><span class=line><span class=cl>    progress_callback: Progress callback function for monitoring
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Returns:
</span></span><span class=line><span class=cl>    str: Comprehensive reference intelligence analysis result
</span></span></code></pre></td></tr></table></div></div><p>ç¿»è¯‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>æ­¤æ™ºèƒ½ä»£ç†ï¼ˆAgentï¼‰åˆ©ç”¨å…ˆè¿›çš„ AI åˆ†æç®—æ³•ï¼Œè‡ªä¸»å¤„ç†ç ”ç©¶æ–‡çŒ®å¹¶æ¢ç´¢ç›¸å…³å·¥ä½œã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>å‚æ•° (Args):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    dir_info: å·¥ä½œåŒºåŸºç¡€è®¾æ–½å…ƒæ•°æ®
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    logger: ç”¨äºæ™ºèƒ½è·Ÿè¸ªçš„æ—¥å¿—è®°å½•å™¨å®ä¾‹
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    progress_callback: ç”¨äºè¿›åº¦ç›‘æ§çš„å›è°ƒå‡½æ•°
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>è¿”å›å€¼ (Returns):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    str: è¯¦å°½çš„æ–‡çŒ®æ™ºèƒ½åˆ†æç»“æœ
</span></span></code></pre></td></tr></table></div></div><p>å‘ƒå‘ƒå‘ƒä¸ç®¡æ€ä¹ˆçœ‹ï¼Œéƒ½è§‰å¾—è¿™ä¸ªè¯´çš„å¾ˆé‚ªä¹å§ï¼Œæ€»ä¹‹è®©æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹</p><p>é¦–å…ˆcheckäº†ä¸€ä¸‹ä¹‹å‰æœ‰æ²¡æœ‰åˆ›å»ºè¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œæœ€æ ¸å¿ƒçš„æ˜¯ä¸‹é¢çš„å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>reference_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>paper_reference_analyzer</span><span class=p>(</span><span class=n>dir_info</span><span class=p>[</span><span class=s2>&#34;paper_dir&#34;</span><span class=p>],</span> <span class=n>logger</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è®©æˆ‘ä»¬è¿›æ¥çœ‹çœ‹<code>paper_reference_analyzer</code></p><p>è¿™ä¸ªå‡½æ•°çš„æ³¨é‡Šæ˜¯ï¼šRun the paper reference analysis and GitHub repository workflow.</p><p>ç¿»è¯‘ä¸€ä¸‹ï¼šè¿è¡Œè®ºæ–‡æ–‡çŒ®åˆ†æä¸ GitHub ä»“åº“å·¥ä½œæµã€‚</p><p>é¹…æˆ‘å‹‰å¼ºçŒœä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯è·å–è®ºæ–‡å†…å®¹é‡Œçš„githubä»“åº“ï¼Œå¹¶åˆ†æï¼Ÿæ€»ä¹‹æˆ‘ä»¬ç»§ç»­çœ‹</p><p>ç„¶åä¸‹é¢å°±æ˜¯æ–°å»ºä¸€ä¸ªAgentå¼€å§‹è·‘äº†ç…§ä¾‹å…ˆçœ‹ä»–çš„prompt</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>You are an expert academic paper reference analyzer specializing in computer science and machine learning.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Task: Analyze paper and identify 5 most relevant references that have GitHub repositories.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Constraints:
</span></span><span class=line><span class=cl><span class=k>-</span> ONLY select references with GitHub repositories
</span></span><span class=line><span class=cl><span class=k>-</span> DO NOT use target paper&#39;s official implementation
</span></span><span class=line><span class=cl><span class=k>-</span> DO NOT use repositories directly associated with target paper
</span></span><span class=line><span class=cl><span class=k>-</span> CAN analyze code implementations from referenced papers
</span></span><span class=line><span class=cl><span class=k>-</span> Focus on references with good implementations solving similar problems
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Analysis Criteria:
</span></span><span class=line><span class=cl><span class=k>1.</span> GitHub Repository Quality (40%):
</span></span><span class=line><span class=cl>   <span class=k>-</span> Star count, activity, maintenance
</span></span><span class=line><span class=cl>   <span class=k>-</span> Documentation quality
</span></span><span class=line><span class=cl>   <span class=k>-</span> Community adoption
</span></span><span class=line><span class=cl>   <span class=k>-</span> Last update date
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>2.</span> Implementation Relevance (30%):
</span></span><span class=line><span class=cl>   <span class=k>-</span> References from methodology/implementation sections
</span></span><span class=line><span class=cl>   <span class=k>-</span> Algorithmic details
</span></span><span class=line><span class=cl>   <span class=k>-</span> Core component descriptions
</span></span><span class=line><span class=cl>   <span class=k>-</span> Code implementation quality
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>3.</span> Technical Depth (20%):
</span></span><span class=line><span class=cl>   <span class=k>-</span> Algorithm/method similarity
</span></span><span class=line><span class=cl>   <span class=k>-</span> Technical foundation relationship
</span></span><span class=line><span class=cl>   <span class=k>-</span> Implementation details
</span></span><span class=line><span class=cl>   <span class=k>-</span> Code structure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>4.</span> Academic Influence (10%):
</span></span><span class=line><span class=cl>   <span class=k>-</span> Publication venue quality
</span></span><span class=line><span class=cl>   <span class=k>-</span> Author expertise
</span></span><span class=line><span class=cl>   <span class=k>-</span> Research impact
</span></span><span class=line><span class=cl>   <span class=k>-</span> Citation influence
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Analysis Steps:
</span></span><span class=line><span class=cl><span class=k>1.</span> Extract all references from paper
</span></span><span class=line><span class=cl><span class=k>2.</span> Filter references with GitHub repositories
</span></span><span class=line><span class=cl><span class=k>3.</span> Analyze repositories based on criteria
</span></span><span class=line><span class=cl><span class=k>4.</span> Calculate relevance scores
</span></span><span class=line><span class=cl><span class=k>5.</span> Select and rank top 5 references
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Output Format:
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>    &#34;selected_references&#34;: [
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            &#34;rank&#34;: 1,
</span></span><span class=line><span class=cl>            &#34;title&#34;: &#34;paper title&#34;,
</span></span><span class=line><span class=cl>            &#34;authors&#34;: [&#34;author1&#34;, &#34;author2&#34;],
</span></span><span class=line><span class=cl>            &#34;year&#34;: &#34;publication year&#34;,
</span></span><span class=line><span class=cl>            &#34;relevance_score&#34;: 0.95,
</span></span><span class=line><span class=cl>            &#34;citation_context&#34;: &#34;how cited in main paper&#34;,
</span></span><span class=line><span class=cl>            &#34;key_contributions&#34;: [&#34;contribution1&#34;, &#34;contribution2&#34;],
</span></span><span class=line><span class=cl>            &#34;implementation_value&#34;: &#34;why valuable for implementation&#34;,
</span></span><span class=line><span class=cl>            &#34;github_info&#34;: {
</span></span><span class=line><span class=cl>                &#34;repository_url&#34;: &#34;GitHub repository URL&#34;,
</span></span><span class=line><span class=cl>                &#34;stars_count&#34;: &#34;number of stars&#34;,
</span></span><span class=line><span class=cl>                &#34;last_updated&#34;: &#34;last update date&#34;,
</span></span><span class=line><span class=cl>                &#34;repository_quality&#34;: &#34;repository quality assessment&#34;,
</span></span><span class=line><span class=cl>                &#34;key_features&#34;: [&#34;feature1&#34;, &#34;feature2&#34;],
</span></span><span class=line><span class=cl>                &#34;documentation_quality&#34;: &#34;documentation assessment&#34;,
</span></span><span class=line><span class=cl>                &#34;community_activity&#34;: &#34;community engagement description&#34;
</span></span><span class=line><span class=cl>            },
</span></span><span class=line><span class=cl>            &#34;original_reference&#34;: &#34;Complete reference text from paper&#34;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    ],
</span></span><span class=line><span class=cl>    &#34;analysis_summary&#34;: &#34;selection process and key findings&#34;,
</span></span><span class=line><span class=cl>    &#34;github_repositories_found&#34;: &#34;total number of references with GitHub repositories&#34;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆä»ç„¶æ˜¯äººè®¾å®šä¹‰ï¼šæ‚¨æ˜¯ä¸€ä½ä¸“é—¨ä»äº‹è®¡ç®—æœºç§‘å­¦å’Œæœºå™¨å­¦ä¹ çš„å­¦æœ¯è®ºæ–‡å‚è€ƒåˆ†æä¸“å®¶ã€‚</p><p>å†™åˆ°è¿™é‡Œçªç„¶æƒ³èŠä¸€ä¸‹äººè®¾çš„é—®é¢˜ï¼Œæœ€è¿‘çœ‹äº†ä¸å°‘æ–‡ç« éƒ½è¯´è§‰å¾—äººè®¾æ²¡æœ‰ç”¨ï¼Œåªä¼šç™½ç™½æ¶ˆè€—tokensï¼Œbtwæˆ‘è§‰å¾—è‡³å°‘ä¼šç»™agentæŒ‡å¼•å·¥ä½œçš„æ–¹å‘</p><p>ç„¶åæ˜¯ä»»åŠ¡ï¼šåˆ†æè®ºæ–‡å¹¶ç¡®å®š 5 ä¸ªå…·æœ‰ GitHub å­˜å‚¨åº“çš„æœ€ç›¸å…³å‚è€ƒæ–‡çŒ®ã€‚</p><p>ç„¶åæ˜¯ä¸€äº›é™åˆ¶ï¼Œå¤§æ¦‚å°±æ˜¯ä¸è¦ç›´æ¥ç”¨åŸæ–‡ä¸­çš„githubç­‰ç­‰</p><p>ç„¶åæ˜¯å››ä¸ªåˆ†ææ ‡å‡†ï¼š</p><ol><li>githubä»“åº“çš„è´¨é‡è¦å¥½ï¼Œåˆ—äº†ä¸€äº›åˆ¤æ–­æŒ‡æ ‡</li><li>å’Œæœ¬è®ºæ–‡æœ‰å¤šç›¸å…³</li><li>æŠ€æœ¯æ·±åº¦ï¼Œæ¯”å¦‚ç®—æ³•çš„ç›¸ä¼¼æ€§å•¦ï¼Œå®ç°çš„ç»†èŠ‚å•¦</li><li>æœ€åæ˜¯å­¦æœ¯å½±å“åŠ›</li></ol><p>ç„¶åå°±æ˜¯åˆ†ææ­¥éª¤ï¼Œç„¶åå®šä¹‰äº†è¿”å›æ ¼å¼</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹agentç”¨åˆ°çš„mcpï¼Œä¸€ä¸ªfilesystemå°±æ˜¯ç»™agentè¯»è®ºæ–‡å†…å®¹çš„ï¼Œä¸€ä¸ªfetchåº”è¯¥å°±æ˜¯è®©agentè®¿é—®githubä»“åº“çš„ï¼Œä¸è¿‡ä¸ªäººæ„Ÿè§‰è¿™æ ·æ•ˆæœä¼šæ¯”è¾ƒå·®ï¼Œagentæ›´å¤§å¯èƒ½æ˜¯ä»è‡ªå·±çš„è®­ç»ƒæ•°æ®ä¸­æ‰¾åˆ°åˆé€‚çš„ä»“åº“ï¼Œç„¶åç”¨fetchåˆ¤æ–­ï¼Œåº”è¯¥ç»™ä¸€ä¸ªç±»ä¼¼äºgithubæœç´¢çš„mcpæ¥è¾…åŠ©åˆ¤æ–­</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹å‘é€çš„å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>Analyze the research paper in directory: {paper_dir}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Please locate and analyze the markdown (.md) file containing the research paper. <span class=gs>**Focus specifically on the References/Bibliography section**</span> to identify and analyze the 5 most relevant references that have GitHub repositories.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Focus on:
</span></span><span class=line><span class=cl><span class=k>1.</span> <span class=gs>**References section analysis**</span> - Extract all citations from the References/Bibliography part
</span></span><span class=line><span class=cl><span class=k>2.</span> References with high-quality GitHub implementations
</span></span><span class=line><span class=cl><span class=k>3.</span> Papers cited for methodology, algorithms, or core techniques
</span></span><span class=line><span class=cl><span class=k>4.</span> Related work that shares similar technical approaches
</span></span><span class=line><span class=cl><span class=k>5.</span> Implementation references that could provide code patterns
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Goal: Find the most valuable GitHub repositories from the paper&#39;s reference list for code implementation reference.
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆç»™äº†è·¯å¾„ï¼Œç„¶ååˆé‡å¤äº†ä¸‹ç›®æ ‡å’Œæ–¹æ³•ï¼Œè¯¥é˜¶æ®µæ¯”è¾ƒç®€å•ï¼Œåˆ°è¿™å°±ç»“æŸäº†</p><h3 id=phase-6>phase 6</h3><p>è¯¥é˜¶æ®µå«â€œRepository Acquisition Automationâ€ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨å»å¤„ç†githubä»“åº“ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªagent</p><p>å…ˆçœ‹æ³¨é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Automate</span> <span class=n>intelligent</span> <span class=n>repository</span> <span class=n>acquisition</span> <span class=n>with</span> <span class=n>AI</span><span class=o>-</span><span class=n>guided</span> <span class=n>selection</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=n>agent</span> <span class=n>autonomously</span> <span class=n>identifies</span><span class=p>,</span> <span class=n>evaluates</span><span class=p>,</span> <span class=ow>and</span> <span class=n>acquires</span> <span class=n>relevant</span>
</span></span><span class=line><span class=cl><span class=n>repositories</span> <span class=n>using</span> <span class=n>intelligent</span> <span class=n>filtering</span> <span class=ow>and</span> <span class=n>automated</span> <span class=n>download</span> <span class=n>protocols</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>é€šè¿‡ AI å¼•å¯¼çš„é€‰æ‹©ï¼Œå®ç°æ™ºèƒ½ä»“åº“è·å–çš„è‡ªåŠ¨åŒ–ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>æ­¤æ™ºèƒ½ä»£ç†ï¼ˆAgentï¼‰åˆ©ç”¨æ™ºèƒ½ç­›é€‰å’Œè‡ªåŠ¨åŒ–ä¸‹è½½åè®®ï¼Œè‡ªä¸»è¯†åˆ«ã€è¯„ä¼°å¹¶è·å–ç›¸å…³çš„ä»£ç ä»“åº“ã€‚
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆæ˜¯ä¸€ä¸ªä¸‹è½½ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼š<code>github_repo_download</code></p><p>å‡½æ•°æ³¨é‡Šæ˜¯ï¼šâ€œDownload GitHub repositories based on search results.â€ï¼Œç„¶åæˆ‘å¾€ä¸‹ä¸€ä¸ªï¼Œå—¯ï¼Ÿè¿˜tmæ˜¯agentï¼Œè¯´å®è¯æ„Ÿè§‰è¿™ä¸ªé¡¹ç›®æœ‰ç‚¹è¿‡åº¦agentç‚«æŠ€äº†ï¼Œå¾ˆå¤šå¤„åœ°æ–¹æ˜æ˜ç”¨ä»£ç å®ç°ä¼šæ›´åŠ ç¨³å®š && æ•ˆæœæ›´å¥½çš„ï¼Œä½†æ˜¯é¡¹ç›®ä½œè€…é€‰æ‹©å…¨éƒ¨ä½¿ç”¨agentå»å †å ï¼Œç”±äºè¿™æ˜¯ä¸ªå­¦æœ¯æ€§è´¨çš„é¡¹ç›®ï¼Œæˆ‘å§‘ä¸”ç†è§£ä»–å°±æ˜¯ä¸ºäº†ä½“ç°agentè¿™ä¸ªæŠ€æœ¯ï¼Œå¹¶ä¸”ä¸ç”¨å¤ªè€ƒè™‘tokenæ¶ˆè€—ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬ç»§ç»­çœ‹å§</p><p>è¿™é‡Œå®ç°äº†ä¸€ä¸ª<code>github_download_agent</code>ï¼Œæç¤ºè¯éå¸¸ç®€å•ï¼šâ€œDownload github repo to the directory {paper_dir}/code_baseâ€ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰é¡¹ç›®ä¸‹è½½ä¸‹æ¥å‘—ï¼Œè¿™è¿˜è¦agentï¼Ÿï¼ˆbushiï¼Œæˆ‘çœŸæ²¡æœ‰è¯‹æ¯çš„æ„æ€ï¼‰</p><p>mcpæ˜¯<code>filesystem</code>å’Œ<code>github-downloader</code>ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<code>github-downloader</code>æœ‰å“ªäº›å·¥å…·ï¼Œæ¥çœ‹<code>tools/git_command.py</code></p><p>ä¸€å…±æœ‰ä¸‰ä¸ªå·¥å…·ï¼š</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>Python</a>
<a href=/tags/agent/>Agent</a></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Jan 18, 2026 02:00 UTC</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 Dinglz 's Blog</section><section class=powerby>copyright &copy; dinglz<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
</script></body></html>